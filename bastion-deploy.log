=== DEPLOYMENT START: Sun Dec  7 07:05:28 PM UTC 2025 ===
Working directory: /home/ubuntu
User: ubuntu

ðŸ“‹ Files in ansible directory:
-rw-rw-r-- 1 ubuntu ubuntu  822 Nov 18 20:36 deploy-all.yml
-rw-rw-r-- 1 ubuntu ubuntu 4102 Dec  7 18:34 elk-fixed.yml
-rw-rw-r-- 1 ubuntu ubuntu 4102 Dec  7 19:04 elk-stack.yml
-rw-rw-r-- 1 ubuntu ubuntu  487 Dec  7 17:06 install-docker..yml
-rw-rw-r-- 1 ubuntu ubuntu  887 Dec  7 17:16 install-docker.yml
-rw-rw-r-- 1 ubuntu ubuntu  320 Nov 25 20:15 inventory.yml
-rw-rw-r-- 1 ubuntu ubuntu 1989 Nov 18 20:36 setup-webservers.yml
-rw-rw-r-- 1 ubuntu ubuntu  344 Nov 18 20:36 update-known-hosts.yml
-rw-rw-r-- 1 ubuntu ubuntu 1111 Dec  6 19:45 zabbix-agents.yml
-rw-rw-r-- 1 ubuntu ubuntu 2730 Dec  7 16:41 zabbix-setup.yml

ðŸ” Testing connectivity...
web-1.ru-central1.internal | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
zabbix.ru-central1.internal | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
web-2.ru-central1.internal | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
elasticsearch.ru-central1.internal | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
kibana.ru-central1.internal | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}

1ï¸âƒ£  Installing Docker from: install-docker.yml
Using /home/ubuntu/ansible/ansible.cfg as config file

PLAY [Install Docker.io (Ubuntu package)] **************************************

TASK [Gathering Facts] *********************************************************
ok: [web-1.ru-central1.internal]
ok: [web-2.ru-central1.internal]
ok: [zabbix.ru-central1.internal]
ok: [elasticsearch.ru-central1.internal]
ok: [kibana.ru-central1.internal]

TASK [Update apt cache] ********************************************************
changed: [web-1.ru-central1.internal] => {"cache_update_time": 1765134343, "cache_updated": true, "changed": true}
changed: [zabbix.ru-central1.internal] => {"cache_update_time": 1765134343, "cache_updated": true, "changed": true}
changed: [elasticsearch.ru-central1.internal] => {"cache_update_time": 1765134344, "cache_updated": true, "changed": true}
changed: [web-2.ru-central1.internal] => {"cache_update_time": 1765134344, "cache_updated": true, "changed": true}
changed: [kibana.ru-central1.internal] => {"cache_update_time": 1765134348, "cache_updated": true, "changed": true}

TASK [Install docker.io] *******************************************************
ok: [web-1.ru-central1.internal] => {"cache_update_time": 1765134343, "cache_updated": false, "changed": false}
ok: [zabbix.ru-central1.internal] => {"cache_update_time": 1765134343, "cache_updated": false, "changed": false}
ok: [elasticsearch.ru-central1.internal] => {"cache_update_time": 1765134344, "cache_updated": false, "changed": false}
ok: [web-2.ru-central1.internal] => {"cache_update_time": 1765134344, "cache_updated": false, "changed": false}
ok: [kibana.ru-central1.internal] => {"cache_update_time": 1765134348, "cache_updated": false, "changed": false}

TASK [Install Docker Compose] **************************************************
ok: [web-1.ru-central1.internal] => {"cache_update_time": 1765134343, "cache_updated": false, "changed": false}
ok: [zabbix.ru-central1.internal] => {"cache_update_time": 1765134343, "cache_updated": false, "changed": false}
ok: [elasticsearch.ru-central1.internal] => {"cache_update_time": 1765134344, "cache_updated": false, "changed": false}
ok: [kibana.ru-central1.internal] => {"cache_update_time": 1765134348, "cache_updated": false, "changed": false}
ok: [web-2.ru-central1.internal] => {"cache_update_time": 1765134344, "cache_updated": false, "changed": false}

TASK [Ensure Docker is started] ************************************************
ok: [web-1.ru-central1.internal] => {"changed": false, "enabled": true, "name": "docker", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2025-12-07 17:18:59 UTC", "ActiveEnterTimestampMonotonic": "1643874610", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "systemd-journald.socket network-online.target sysinit.target basic.target system.slice docker.socket firewalld.service containerd.service", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2025-12-07 17:18:58 UTC", "AssertTimestampMonotonic": "1643023499", "Before": "multi-user.target shutdown.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "7091949000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2025-12-07 17:18:58 UTC", "ConditionTimestampMonotonic": "1643023498", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/docker.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "yes", "DelegateControllers": "cpu cpuacct cpuset io blkio memory devices pids bpf-firewall bpf-devices bpf-foreign bpf-socket-bind", "Description": "Docker Application Container Engine", "DevicePolicy": "auto", "Documentation": "https://docs.docker.com", "DynamicUser": "no", "EffectiveCPUs": "0-1", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "2180", "ExecMainStartTimestamp": "Sun 2025-12-07 17:18:58 UTC", "ExecMainStartTimestampMonotonic": "1643024179", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/docker.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "docker.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2025-12-07 17:18:58 UTC", "InactiveExitTimestampMonotonic": "1643024370", "InvocationID": "7c2e23be0d464937a006fa0f2d0cb13e", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "infinity", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "infinity", "LimitNOFILESoft": "infinity", "LimitNPROC": "infinity", "LimitNPROCSoft": "infinity", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "2180", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "498941952", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "docker.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "continue", "OOMScoreAdjust": "-500", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "docker.socket sysinit.target system.slice", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "2s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "3", "StartLimitIntervalUSec": "1min", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2025-12-07 17:18:59 UTC", "StateChangeTimestampMonotonic": "1643874610", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "10", "TasksMax": "infinity", "TimeoutAbortUSec": "infinity", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "infinity", "TimerSlackNSec": "50000", "Transient": "no", "TriggeredBy": "docker.socket", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target containerd.service", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
ok: [elasticsearch.ru-central1.internal] => {"changed": false, "enabled": true, "name": "docker", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2025-12-07 17:19:02 UTC", "ActiveEnterTimestampMonotonic": "1646856317", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "network-online.target docker.socket systemd-journald.socket sysinit.target containerd.service firewalld.service system.slice basic.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2025-12-07 17:18:58 UTC", "AssertTimestampMonotonic": "1642970340", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "40415331000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2025-12-07 17:18:58 UTC", "ConditionTimestampMonotonic": "1642970339", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/docker.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "yes", "DelegateControllers": "cpu cpuacct cpuset io blkio memory devices pids bpf-firewall bpf-devices bpf-foreign bpf-socket-bind", "Description": "Docker Application Container Engine", "DevicePolicy": "auto", "Documentation": "https://docs.docker.com", "DynamicUser": "no", "EffectiveCPUs": "0-1", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "2189", "ExecMainStartTimestamp": "Sun 2025-12-07 17:18:58 UTC", "ExecMainStartTimestampMonotonic": "1642971098", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; ignore_errors=no ; start_time=[Sun 2025-12-07 17:18:58 UTC] ; stop_time=[n/a] ; pid=2189 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; flags= ; start_time=[Sun 2025-12-07 17:18:58 UTC] ; stop_time=[n/a] ; pid=2189 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/docker.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "docker.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2025-12-07 17:18:58 UTC", "InactiveExitTimestampMonotonic": "1642971426", "InvocationID": "8224a72ca5a34666b04a20bff73821e5", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "infinity", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "infinity", "LimitNOFILESoft": "infinity", "LimitNPROC": "infinity", "LimitNPROCSoft": "infinity", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "15479", "LimitSIGPENDINGSoft": "15479", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "2189", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "1781501952", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "docker.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "continue", "OOMScoreAdjust": "-500", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target docker.socket system.slice", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "2s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "3", "StartLimitIntervalUSec": "1min", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2025-12-07 17:19:02 UTC", "StateChangeTimestampMonotonic": "1646856317", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "16", "TasksMax": "infinity", "TimeoutAbortUSec": "infinity", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "infinity", "TimerSlackNSec": "50000", "Transient": "no", "TriggeredBy": "docker.socket", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target containerd.service", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
ok: [zabbix.ru-central1.internal] => {"changed": false, "enabled": true, "name": "docker", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2025-12-07 17:19:03 UTC", "ActiveEnterTimestampMonotonic": "1638269777", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "basic.target network-online.target system.slice systemd-journald.socket sysinit.target firewalld.service docker.socket containerd.service", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2025-12-07 17:18:59 UTC", "AssertTimestampMonotonic": "1634351058", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "11803779000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2025-12-07 17:18:59 UTC", "ConditionTimestampMonotonic": "1634351056", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/docker.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "yes", "DelegateControllers": "cpu cpuacct cpuset io blkio memory devices pids bpf-firewall bpf-devices bpf-foreign bpf-socket-bind", "Description": "Docker Application Container Engine", "DevicePolicy": "auto", "Documentation": "https://docs.docker.com", "DynamicUser": "no", "EffectiveCPUs": "0-1", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "2329", "ExecMainStartTimestamp": "Sun 2025-12-07 17:18:59 UTC", "ExecMainStartTimestampMonotonic": "1634351937", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; ignore_errors=no ; start_time=[Sun 2025-12-07 17:18:59 UTC] ; stop_time=[n/a] ; pid=2329 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; flags= ; start_time=[Sun 2025-12-07 17:18:59 UTC] ; stop_time=[n/a] ; pid=2329 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/docker.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "docker.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2025-12-07 17:18:59 UTC", "InactiveExitTimestampMonotonic": "1634352392", "InvocationID": "24a1c3e547f34223a8191e4592b1c795", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "infinity", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "infinity", "LimitNOFILESoft": "infinity", "LimitNPROC": "infinity", "LimitNPROCSoft": "infinity", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "15479", "LimitSIGPENDINGSoft": "15479", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "2329", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "647430144", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "docker.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "continue", "OOMScoreAdjust": "-500", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "docker.socket system.slice sysinit.target", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "2s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "3", "StartLimitIntervalUSec": "1min", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2025-12-07 17:19:03 UTC", "StateChangeTimestampMonotonic": "1638269777", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "60", "TasksMax": "infinity", "TimeoutAbortUSec": "infinity", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "infinity", "TimerSlackNSec": "50000", "Transient": "no", "TriggeredBy": "docker.socket", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "containerd.service network-online.target", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
ok: [web-2.ru-central1.internal] => {"changed": false, "enabled": true, "name": "docker", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2025-12-07 17:18:59 UTC", "ActiveEnterTimestampMonotonic": "1645072617", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "sysinit.target network-online.target basic.target docker.socket containerd.service firewalld.service system.slice systemd-journald.socket", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2025-12-07 17:18:58 UTC", "AssertTimestampMonotonic": "1644230484", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "8270631000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2025-12-07 17:18:58 UTC", "ConditionTimestampMonotonic": "1644230482", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/docker.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "yes", "DelegateControllers": "cpu cpuacct cpuset io blkio memory devices pids bpf-firewall bpf-devices bpf-foreign bpf-socket-bind", "Description": "Docker Application Container Engine", "DevicePolicy": "auto", "Documentation": "https://docs.docker.com", "DynamicUser": "no", "EffectiveCPUs": "0-1", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "2175", "ExecMainStartTimestamp": "Sun 2025-12-07 17:18:58 UTC", "ExecMainStartTimestampMonotonic": "1644231626", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/docker.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "docker.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2025-12-07 17:18:58 UTC", "InactiveExitTimestampMonotonic": "1644232103", "InvocationID": "65c0639bfdf34a87babdf5197c3ca408", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "infinity", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "infinity", "LimitNOFILESoft": "infinity", "LimitNPROC": "infinity", "LimitNPROCSoft": "infinity", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "2175", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "499171328", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "docker.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "continue", "OOMScoreAdjust": "-500", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "docker.socket sysinit.target system.slice", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "2s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "3", "StartLimitIntervalUSec": "1min", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2025-12-07 17:18:59 UTC", "StateChangeTimestampMonotonic": "1645072617", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "10", "TasksMax": "infinity", "TimeoutAbortUSec": "infinity", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "infinity", "TimerSlackNSec": "50000", "Transient": "no", "TriggeredBy": "docker.socket", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "containerd.service network-online.target", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
ok: [kibana.ru-central1.internal] => {"changed": false, "enabled": true, "name": "docker", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2025-12-07 17:19:03 UTC", "ActiveEnterTimestampMonotonic": "1642554690", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "containerd.service systemd-journald.socket docker.socket network-online.target firewalld.service sysinit.target basic.target system.slice", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2025-12-07 17:19:02 UTC", "AssertTimestampMonotonic": "1640959522", "Before": "multi-user.target shutdown.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "72707547000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2025-12-07 17:19:02 UTC", "ConditionTimestampMonotonic": "1640959520", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/docker.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "yes", "DelegateControllers": "cpu cpuacct cpuset io blkio memory devices pids bpf-firewall bpf-devices bpf-foreign bpf-socket-bind", "Description": "Docker Application Container Engine", "DevicePolicy": "auto", "Documentation": "https://docs.docker.com", "DynamicUser": "no", "EffectiveCPUs": "0-1", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "2186", "ExecMainStartTimestamp": "Sun 2025-12-07 17:19:02 UTC", "ExecMainStartTimestampMonotonic": "1640960265", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; ignore_errors=no ; start_time=[Sun 2025-12-07 17:19:02 UTC] ; stop_time=[n/a] ; pid=2186 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; flags= ; start_time=[Sun 2025-12-07 17:19:02 UTC] ; stop_time=[n/a] ; pid=2186 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/docker.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "docker.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2025-12-07 17:19:02 UTC", "InactiveExitTimestampMonotonic": "1640960465", "InvocationID": "4c04d47227c54308aeec924bf7e7154c", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "infinity", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "infinity", "LimitNOFILESoft": "infinity", "LimitNPROC": "infinity", "LimitNPROCSoft": "infinity", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "2186", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "393801728", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "docker.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "continue", "OOMScoreAdjust": "-500", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice docker.socket", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "2s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "3", "StartLimitIntervalUSec": "1min", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2025-12-07 17:19:03 UTC", "StateChangeTimestampMonotonic": "1642554690", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "17", "TasksMax": "infinity", "TimeoutAbortUSec": "infinity", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "infinity", "TimerSlackNSec": "50000", "Transient": "no", "TriggeredBy": "docker.socket", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "containerd.service network-online.target", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}

TASK [Install Python Docker module] ********************************************
ok: [web-1.ru-central1.internal] => {"cache_update_time": 1765134343, "cache_updated": false, "changed": false}
ok: [zabbix.ru-central1.internal] => {"cache_update_time": 1765134343, "cache_updated": false, "changed": false}
ok: [elasticsearch.ru-central1.internal] => {"cache_update_time": 1765134344, "cache_updated": false, "changed": false}
ok: [kibana.ru-central1.internal] => {"cache_update_time": 1765134348, "cache_updated": false, "changed": false}
ok: [web-2.ru-central1.internal] => {"cache_update_time": 1765134344, "cache_updated": false, "changed": false}

TASK [Add ubuntu user to docker group] *****************************************
ok: [web-1.ru-central1.internal] => {"append": true, "changed": false, "comment": "Ubuntu", "group": 1000, "groups": "docker", "home": "/home/ubuntu", "move_home": false, "name": "ubuntu", "shell": "/bin/bash", "state": "present", "uid": 1000}
ok: [zabbix.ru-central1.internal] => {"append": true, "changed": false, "comment": "Ubuntu", "group": 1000, "groups": "docker", "home": "/home/ubuntu", "move_home": false, "name": "ubuntu", "shell": "/bin/bash", "state": "present", "uid": 1000}
ok: [elasticsearch.ru-central1.internal] => {"append": true, "changed": false, "comment": "Ubuntu", "group": 1000, "groups": "docker", "home": "/home/ubuntu", "move_home": false, "name": "ubuntu", "shell": "/bin/bash", "state": "present", "uid": 1000}
ok: [web-2.ru-central1.internal] => {"append": true, "changed": false, "comment": "Ubuntu", "group": 1000, "groups": "docker", "home": "/home/ubuntu", "move_home": false, "name": "ubuntu", "shell": "/bin/bash", "state": "present", "uid": 1000}
ok: [kibana.ru-central1.internal] => {"append": true, "changed": false, "comment": "Ubuntu", "group": 1000, "groups": "docker", "home": "/home/ubuntu", "move_home": false, "name": "ubuntu", "shell": "/bin/bash", "state": "present", "uid": 1000}

TASK [Verify Docker installation] **********************************************
ok: [web-1.ru-central1.internal] => {"changed": false, "cmd": "docker --version", "delta": "0:00:00.011772", "end": "2025-12-07 19:05:57.575151", "rc": 0, "start": "2025-12-07 19:05:57.563379", "stderr": "", "stderr_lines": [], "stdout": "Docker version 28.2.2, build 28.2.2-0ubuntu1~22.04.1", "stdout_lines": ["Docker version 28.2.2, build 28.2.2-0ubuntu1~22.04.1"]}
ok: [elasticsearch.ru-central1.internal] => {"changed": false, "cmd": "docker --version", "delta": "0:00:00.014650", "end": "2025-12-07 19:05:57.568900", "rc": 0, "start": "2025-12-07 19:05:57.554250", "stderr": "", "stderr_lines": [], "stdout": "Docker version 28.2.2, build 28.2.2-0ubuntu1~22.04.1", "stdout_lines": ["Docker version 28.2.2, build 28.2.2-0ubuntu1~22.04.1"]}
ok: [zabbix.ru-central1.internal] => {"changed": false, "cmd": "docker --version", "delta": "0:00:00.015221", "end": "2025-12-07 19:05:57.577751", "rc": 0, "start": "2025-12-07 19:05:57.562530", "stderr": "", "stderr_lines": [], "stdout": "Docker version 28.2.2, build 28.2.2-0ubuntu1~22.04.1", "stdout_lines": ["Docker version 28.2.2, build 28.2.2-0ubuntu1~22.04.1"]}
ok: [web-2.ru-central1.internal] => {"changed": false, "cmd": "docker --version", "delta": "0:00:00.020693", "end": "2025-12-07 19:05:57.651213", "rc": 0, "start": "2025-12-07 19:05:57.630520", "stderr": "", "stderr_lines": [], "stdout": "Docker version 28.2.2, build 28.2.2-0ubuntu1~22.04.1", "stdout_lines": ["Docker version 28.2.2, build 28.2.2-0ubuntu1~22.04.1"]}
ok: [kibana.ru-central1.internal] => {"changed": false, "cmd": "docker --version", "delta": "0:00:00.370591", "end": "2025-12-07 19:05:57.951863", "rc": 0, "start": "2025-12-07 19:05:57.581272", "stderr": "", "stderr_lines": [], "stdout": "Docker version 28.2.2, build 28.2.2-0ubuntu1~22.04.1", "stdout_lines": ["Docker version 28.2.2, build 28.2.2-0ubuntu1~22.04.1"]}

TASK [debug] *******************************************************************
ok: [web-1.ru-central1.internal] => {
    "msg": "âœ… Docker installed: Docker version 28.2.2, build 28.2.2-0ubuntu1~22.04.1"
}
ok: [web-2.ru-central1.internal] => {
    "msg": "âœ… Docker installed: Docker version 28.2.2, build 28.2.2-0ubuntu1~22.04.1"
}
ok: [elasticsearch.ru-central1.internal] => {
    "msg": "âœ… Docker installed: Docker version 28.2.2, build 28.2.2-0ubuntu1~22.04.1"
}
ok: [zabbix.ru-central1.internal] => {
    "msg": "âœ… Docker installed: Docker version 28.2.2, build 28.2.2-0ubuntu1~22.04.1"
}
ok: [kibana.ru-central1.internal] => {
    "msg": "âœ… Docker installed: Docker version 28.2.2, build 28.2.2-0ubuntu1~22.04.1"
}

PLAY RECAP *********************************************************************
elasticsearch.ru-central1.internal : ok=9    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
kibana.ru-central1.internal : ok=9    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
web-1.ru-central1.internal : ok=9    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
web-2.ru-central1.internal : ok=9    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
zabbix.ru-central1.internal : ok=9    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   


2ï¸âƒ£  Setting up web servers
Using /home/ubuntu/ansible/ansible.cfg as config file

PLAY [Setup web servers with nginx] ********************************************

TASK [Gathering Facts] *********************************************************
ok: [web-1.ru-central1.internal]
ok: [web-2.ru-central1.internal]

TASK [Update apt package cache] ************************************************
changed: [web-1.ru-central1.internal] => {"cache_update_time": 1765134361, "cache_updated": true, "changed": true}
changed: [web-2.ru-central1.internal] => {"cache_update_time": 1765134361, "cache_updated": true, "changed": true}

TASK [Install nginx] ***********************************************************
ok: [web-1.ru-central1.internal] => {"cache_update_time": 1765134361, "cache_updated": false, "changed": false}
ok: [web-2.ru-central1.internal] => {"cache_update_time": 1765134361, "cache_updated": false, "changed": false}

TASK [Create simple index.html] ************************************************
ok: [web-1.ru-central1.internal] => {"changed": false, "checksum": "8092a430b813f72ac3cf573690c176603dd8cb23", "dest": "/var/www/html/index.html", "gid": 33, "group": "www-data", "mode": "0644", "owner": "www-data", "path": "/var/www/html/index.html", "size": 263, "state": "file", "uid": 33}
ok: [web-2.ru-central1.internal] => {"changed": false, "checksum": "71849a2c244e6998ee0fa5ef01953edb3e7a5ae3", "dest": "/var/www/html/index.html", "gid": 33, "group": "www-data", "mode": "0644", "owner": "www-data", "path": "/var/www/html/index.html", "size": 263, "state": "file", "uid": 33}

TASK [Ensure nginx default config is correct] **********************************
ok: [web-1.ru-central1.internal] => {"changed": false, "checksum": "9d24fb6931ed0624037fc80fa5b08a9323191c9a", "dest": "/etc/nginx/sites-available/default", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/nginx/sites-available/default", "size": 216, "state": "file", "uid": 0}
ok: [web-2.ru-central1.internal] => {"changed": false, "checksum": "9d24fb6931ed0624037fc80fa5b08a9323191c9a", "dest": "/etc/nginx/sites-available/default", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/nginx/sites-available/default", "size": 216, "state": "file", "uid": 0}

TASK [Test nginx configuration] ************************************************
ok: [web-1.ru-central1.internal] => {"changed": false, "cmd": ["nginx", "-t"], "delta": "0:00:00.009402", "end": "2025-12-07 19:06:06.096326", "rc": 0, "start": "2025-12-07 19:06:06.086924", "stderr": "nginx: the configuration file /etc/nginx/nginx.conf syntax is ok\nnginx: configuration file /etc/nginx/nginx.conf test is successful", "stderr_lines": ["nginx: the configuration file /etc/nginx/nginx.conf syntax is ok", "nginx: configuration file /etc/nginx/nginx.conf test is successful"], "stdout": "", "stdout_lines": []}
ok: [web-2.ru-central1.internal] => {"changed": false, "cmd": ["nginx", "-t"], "delta": "0:00:00.010973", "end": "2025-12-07 19:06:06.102523", "rc": 0, "start": "2025-12-07 19:06:06.091550", "stderr": "nginx: the configuration file /etc/nginx/nginx.conf syntax is ok\nnginx: configuration file /etc/nginx/nginx.conf test is successful", "stderr_lines": ["nginx: the configuration file /etc/nginx/nginx.conf syntax is ok", "nginx: configuration file /etc/nginx/nginx.conf test is successful"], "stdout": "", "stdout_lines": []}

TASK [debug] *******************************************************************
ok: [web-1.ru-central1.internal] => {
    "nginx_test.stdout": ""
}
ok: [web-2.ru-central1.internal] => {
    "nginx_test.stdout": ""
}

TASK [Start and enable nginx] **************************************************
ok: [web-1.ru-central1.internal] => {"changed": false, "enabled": true, "name": "nginx", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2025-12-07 17:19:54 UTC", "ActiveEnterTimestampMonotonic": "1698655968", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "system.slice nss-lookup.target systemd-journald.socket network.target sysinit.target basic.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2025-12-07 17:19:54 UTC", "AssertTimestampMonotonic": "1698647047", "Before": "multi-user.target shutdown.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "1083642000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2025-12-07 17:19:54 UTC", "ConditionTimestampMonotonic": "1698647045", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/nginx.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "A high performance web server and a reverse proxy server", "DevicePolicy": "auto", "Documentation": "\"man:nginx(8)\"", "DynamicUser": "no", "EffectiveCPUs": "0-1", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "3689", "ExecMainStartTimestamp": "Sun 2025-12-07 17:19:56 UTC", "ExecMainStartTimestampMonotonic": "1700900847", "ExecMainStatus": "0", "ExecReload": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; -s reload ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; -s reload ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPre": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -t -q -g daemon on; master_process on; ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPreEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -t -q -g daemon on; master_process on; ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStop": "{ path=/sbin/start-stop-daemon ; argv[]=/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /run/nginx.pid ; ignore_errors=yes ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStopEx": "{ path=/sbin/start-stop-daemon ; argv[]=/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /run/nginx.pid ; flags=ignore-failure ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/nginx.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "nginx.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2025-12-07 17:19:54 UTC", "InactiveExitTimestampMonotonic": "1698648267", "InvocationID": "6f1e4b12d0414e48ae271a4045536d70", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "mixed", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "3689", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "7151616", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "nginx.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "PIDFile": "/run/nginx.pid", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "no", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2025-12-07 17:19:54 UTC", "StateChangeTimestampMonotonic": "1698655968", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "3", "TasksMax": "2305", "TimeoutAbortUSec": "5s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "5s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "forking", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
ok: [web-2.ru-central1.internal] => {"changed": false, "enabled": true, "name": "nginx", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2025-12-07 17:19:54 UTC", "ActiveEnterTimestampMonotonic": "1699921677", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "sysinit.target basic.target nss-lookup.target network.target systemd-journald.socket system.slice", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2025-12-07 17:19:54 UTC", "AssertTimestampMonotonic": "1699910668", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "1507594000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2025-12-07 17:19:54 UTC", "ConditionTimestampMonotonic": "1699910665", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/nginx.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "A high performance web server and a reverse proxy server", "DevicePolicy": "auto", "Documentation": "\"man:nginx(8)\"", "DynamicUser": "no", "EffectiveCPUs": "0-1", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "3688", "ExecMainStartTimestamp": "Sun 2025-12-07 17:19:56 UTC", "ExecMainStartTimestampMonotonic": "1702081544", "ExecMainStatus": "0", "ExecReload": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; -s reload ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; -s reload ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPre": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -t -q -g daemon on; master_process on; ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPreEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -t -q -g daemon on; master_process on; ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStop": "{ path=/sbin/start-stop-daemon ; argv[]=/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /run/nginx.pid ; ignore_errors=yes ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStopEx": "{ path=/sbin/start-stop-daemon ; argv[]=/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /run/nginx.pid ; flags=ignore-failure ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/nginx.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "nginx.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2025-12-07 17:19:54 UTC", "InactiveExitTimestampMonotonic": "1699912334", "InvocationID": "f280be42b1fa4b9a905225c42061642d", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "mixed", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "3688", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "7127040", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "nginx.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "PIDFile": "/run/nginx.pid", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "no", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2025-12-07 17:19:54 UTC", "StateChangeTimestampMonotonic": "1699921677", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "3", "TasksMax": "2305", "TimeoutAbortUSec": "5s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "5s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "forking", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}

TASK [Check nginx is listening on port 80] *************************************
ok: [web-1.ru-central1.internal] => {"changed": false, "elapsed": 0, "match_groupdict": {}, "match_groups": [], "path": null, "port": 80, "search_regex": null, "state": "started"}
ok: [web-2.ru-central1.internal] => {"changed": false, "elapsed": 0, "match_groupdict": {}, "match_groups": [], "path": null, "port": 80, "search_regex": null, "state": "started"}

TASK [Test HTTP response] ******************************************************
ok: [web-1.ru-central1.internal] => {"accept_ranges": "bytes", "changed": false, "connection": "close", "content": "<html>\n<head>\n    <title>Web Server web-1.ru-central1.internal</title>\n</head>\n<body>\n    <h1>Hello from web-1.ru-central1.internal</h1>\n    <p>This is web server in Yandex Cloud</p>\n    <p>Server IP: 192.168.20.24</p>\n    <p>Powered by Nginx</p>\n</body>\n</html>\n", "content_length": "263", "content_type": "text/html", "cookies": {}, "cookies_string": "", "date": "Sun, 07 Dec 2025 19:06:07 GMT", "elapsed": 0, "etag": "\"6935b740-107\"", "last_modified": "Sun, 07 Dec 2025 17:20:00 GMT", "msg": "OK (263 bytes)", "redirected": false, "server": "nginx/1.18.0 (Ubuntu)", "status": 200, "url": "http://localhost"}
ok: [web-2.ru-central1.internal] => {"accept_ranges": "bytes", "changed": false, "connection": "close", "content": "<html>\n<head>\n    <title>Web Server web-2.ru-central1.internal</title>\n</head>\n<body>\n    <h1>Hello from web-2.ru-central1.internal</h1>\n    <p>This is web server in Yandex Cloud</p>\n    <p>Server IP: 192.168.20.16</p>\n    <p>Powered by Nginx</p>\n</body>\n</html>\n", "content_length": "263", "content_type": "text/html", "cookies": {}, "cookies_string": "", "date": "Sun, 07 Dec 2025 19:06:07 GMT", "elapsed": 0, "etag": "\"6935b740-107\"", "last_modified": "Sun, 07 Dec 2025 17:20:00 GMT", "msg": "OK (263 bytes)", "redirected": false, "server": "nginx/1.18.0 (Ubuntu)", "status": 200, "url": "http://localhost"}

TASK [debug] *******************************************************************
ok: [web-1.ru-central1.internal] => {
    "msg": "Nginx is working! HTTP status: 200"
}
ok: [web-2.ru-central1.internal] => {
    "msg": "Nginx is working! HTTP status: 200"
}

PLAY RECAP *********************************************************************
web-1.ru-central1.internal : ok=11   changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
web-2.ru-central1.internal : ok=11   changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   


3ï¸âƒ£  Deploying Zabbix
Using /home/ubuntu/ansible/ansible.cfg as config file

PLAY [Install Zabbix Server using Docker] **************************************

TASK [Gathering Facts] *********************************************************
ok: [zabbix.ru-central1.internal]

TASK [Update apt cache] ********************************************************
changed: [zabbix.ru-central1.internal] => {"cache_update_time": 1765134370, "cache_updated": true, "changed": true}

TASK [Create Zabbix directory] *************************************************
ok: [zabbix.ru-central1.internal] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/opt/zabbix", "size": 4096, "state": "directory", "uid": 0}

TASK [Create Zabbix Docker Compose file] ***************************************
ok: [zabbix.ru-central1.internal] => {"changed": false, "checksum": "a618415972c1d81dab1ea0edde1eb34ee9e10183", "dest": "/opt/zabbix/docker-compose.yml", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/opt/zabbix/docker-compose.yml", "size": 925, "state": "file", "uid": 0}

TASK [Check if Docker is installed] ********************************************
ok: [zabbix.ru-central1.internal] => {"changed": false, "stat": {"atime": 1765127984.2855432, "attr_flags": "e", "attributes": ["extents"], "block_size": 4096, "blocks": 60384, "charset": "binary", "checksum": "30b45c18e38efafb9dbfa98ea44b4f5d1d479cef", "ctime": 1765127936.7680786, "dev": 64513, "device_type": 0, "executable": true, "exists": true, "gid": 0, "gr_name": "root", "inode": 6020, "isblk": false, "ischr": false, "isdir": false, "isfifo": false, "isgid": false, "islnk": false, "isreg": true, "issock": false, "isuid": false, "mimetype": "application/x-pie-executable", "mode": "0755", "mtime": 1757515816.0, "nlink": 1, "path": "/usr/bin/docker", "pw_name": "root", "readable": true, "rgrp": true, "roth": true, "rusr": true, "size": 30915736, "uid": 0, "version": "3271850708", "wgrp": false, "woth": false, "writeable": true, "wusr": true, "xgrp": true, "xoth": true, "xusr": true}}

TASK [Install Docker.io if not present] ****************************************
skipping: [zabbix.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}

TASK [Ensure Docker is started] ************************************************
ok: [zabbix.ru-central1.internal] => {"changed": false, "enabled": true, "name": "docker", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2025-12-07 17:19:03 UTC", "ActiveEnterTimestampMonotonic": "1638269777", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "basic.target network-online.target system.slice systemd-journald.socket sysinit.target firewalld.service docker.socket containerd.service", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2025-12-07 17:18:59 UTC", "AssertTimestampMonotonic": "1634351058", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "11811019000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2025-12-07 17:18:59 UTC", "ConditionTimestampMonotonic": "1634351056", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/docker.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "yes", "DelegateControllers": "cpu cpuacct cpuset io blkio memory devices pids bpf-firewall bpf-devices bpf-foreign bpf-socket-bind", "Description": "Docker Application Container Engine", "DevicePolicy": "auto", "Documentation": "https://docs.docker.com", "DynamicUser": "no", "EffectiveCPUs": "0-1", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "2329", "ExecMainStartTimestamp": "Sun 2025-12-07 17:18:59 UTC", "ExecMainStartTimestampMonotonic": "1634351937", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; ignore_errors=no ; start_time=[Sun 2025-12-07 17:18:59 UTC] ; stop_time=[n/a] ; pid=2329 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; flags= ; start_time=[Sun 2025-12-07 17:18:59 UTC] ; stop_time=[n/a] ; pid=2329 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/docker.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "docker.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2025-12-07 17:18:59 UTC", "InactiveExitTimestampMonotonic": "1634352392", "InvocationID": "24a1c3e547f34223a8191e4592b1c795", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "infinity", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "infinity", "LimitNOFILESoft": "infinity", "LimitNPROC": "infinity", "LimitNPROCSoft": "infinity", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "15479", "LimitSIGPENDINGSoft": "15479", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "2329", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "647430144", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "docker.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "continue", "OOMScoreAdjust": "-500", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "docker.socket system.slice sysinit.target", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "2s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "3", "StartLimitIntervalUSec": "1min", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2025-12-07 17:19:03 UTC", "StateChangeTimestampMonotonic": "1638269777", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "60", "TasksMax": "infinity", "TimeoutAbortUSec": "infinity", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "infinity", "TimerSlackNSec": "50000", "Transient": "no", "TriggeredBy": "docker.socket", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "containerd.service network-online.target", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}

TASK [Run Zabbix stack with Docker Compose] ************************************
changed: [zabbix.ru-central1.internal] => {"changed": true, "cmd": "cd /opt/zabbix\ndocker-compose up -d\n", "delta": "0:00:00.291727", "end": "2025-12-07 19:06:14.233736", "rc": 0, "start": "2025-12-07 19:06:13.942009", "stderr": "zabbix_zabbix-database_1 is up-to-date\nzabbix_zabbix-server_1 is up-to-date\nzabbix_zabbix-web_1 is up-to-date", "stderr_lines": ["zabbix_zabbix-database_1 is up-to-date", "zabbix_zabbix-server_1 is up-to-date", "zabbix_zabbix-web_1 is up-to-date"], "stdout": "", "stdout_lines": []}

TASK [Wait for Zabbix to start] ************************************************
ok: [zabbix.ru-central1.internal] => {"changed": false, "elapsed": 0, "match_groupdict": {}, "match_groups": [], "path": null, "port": 80, "search_regex": null, "state": "started"}

TASK [Display Zabbix access info] **********************************************
ok: [zabbix.ru-central1.internal] => {
    "msg": "ðŸŽ‰ Zabbix installed successfully!\nðŸŒ Access URL: http://zabbix.ru-central1.internal/\nðŸ”‘ Login: Admin\nðŸ”’ Password: zabbix"
}

PLAY RECAP *********************************************************************
zabbix.ru-central1.internal : ok=9    changed=2    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   


4ï¸âƒ£  Installing Zabbix agents
Using /home/ubuntu/ansible/ansible.cfg as config file

PLAY [Install and configure Zabbix Agents] *************************************

TASK [Gathering Facts] *********************************************************
ok: [web-1.ru-central1.internal]
ok: [web-2.ru-central1.internal]

TASK [Update apt package cache] ************************************************
changed: [web-1.ru-central1.internal] => {"cache_update_time": 1765134377, "cache_updated": true, "changed": true}
changed: [web-2.ru-central1.internal] => {"cache_update_time": 1765134378, "cache_updated": true, "changed": true}

TASK [Install Zabbix Agent] ****************************************************
ok: [web-1.ru-central1.internal] => {"cache_update_time": 1765134377, "cache_updated": false, "changed": false}
ok: [web-2.ru-central1.internal] => {"cache_update_time": 1765134378, "cache_updated": false, "changed": false}

TASK [Configure Zabbix Agent] **************************************************
ok: [web-1.ru-central1.internal] => (item=Server=zabbix.ru-central1.internal) => {"ansible_loop_var": "item", "backup": "", "changed": false, "item": "Server=zabbix.ru-central1.internal", "msg": ""}
ok: [web-2.ru-central1.internal] => (item=Server=zabbix.ru-central1.internal) => {"ansible_loop_var": "item", "backup": "", "changed": false, "item": "Server=zabbix.ru-central1.internal", "msg": ""}
ok: [web-1.ru-central1.internal] => (item=ServerActive=zabbix.ru-central1.internal) => {"ansible_loop_var": "item", "backup": "", "changed": false, "item": "ServerActive=zabbix.ru-central1.internal", "msg": ""}
ok: [web-2.ru-central1.internal] => (item=ServerActive=zabbix.ru-central1.internal) => {"ansible_loop_var": "item", "backup": "", "changed": false, "item": "ServerActive=zabbix.ru-central1.internal", "msg": ""}
ok: [web-1.ru-central1.internal] => (item=Hostname=web-1.ru-central1.internal) => {"ansible_loop_var": "item", "backup": "", "changed": false, "item": "Hostname=web-1.ru-central1.internal", "msg": ""}
ok: [web-2.ru-central1.internal] => (item=Hostname=web-2.ru-central1.internal) => {"ansible_loop_var": "item", "backup": "", "changed": false, "item": "Hostname=web-2.ru-central1.internal", "msg": ""}
ok: [web-1.ru-central1.internal] => (item=EnableRemoteCommands=1) => {"ansible_loop_var": "item", "backup": "", "changed": false, "item": "EnableRemoteCommands=1", "msg": ""}
ok: [web-2.ru-central1.internal] => (item=EnableRemoteCommands=1) => {"ansible_loop_var": "item", "backup": "", "changed": false, "item": "EnableRemoteCommands=1", "msg": ""}
ok: [web-1.ru-central1.internal] => (item=HostMetadata=Linux) => {"ansible_loop_var": "item", "backup": "", "changed": false, "item": "HostMetadata=Linux", "msg": ""}
ok: [web-2.ru-central1.internal] => (item=HostMetadata=Linux) => {"ansible_loop_var": "item", "backup": "", "changed": false, "item": "HostMetadata=Linux", "msg": ""}

TASK [Start and enable Zabbix Agent] *******************************************
changed: [web-1.ru-central1.internal] => {"changed": true, "enabled": true, "name": "zabbix-agent", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2025-12-07 17:48:50 UTC", "ActiveEnterTimestampMonotonic": "3434186357", "ActiveExitTimestamp": "Sun 2025-12-07 17:48:50 UTC", "ActiveExitTimestampMonotonic": "3434183183", "ActiveState": "active", "After": "sysinit.target network.target basic.target system.slice systemd-journald.socket", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2025-12-07 17:48:50 UTC", "AssertTimestampMonotonic": "3434185452", "Before": "multi-user.target shutdown.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "699913000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2025-12-07 17:48:50 UTC", "ConditionTimestampMonotonic": "3434185450", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/zabbix-agent.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "Zabbix Agent", "DevicePolicy": "auto", "Documentation": "man:zabbix_agentd", "DynamicUser": "no", "EffectiveCPUs": "0-1", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "11031", "ExecMainStartTimestamp": "Sun 2025-12-07 17:48:50 UTC", "ExecMainStartTimestampMonotonic": "3434186169", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/sbin/zabbix_agentd ; argv[]=/usr/sbin/zabbix_agentd --foreground ; ignore_errors=no ; start_time=[Sun 2025-12-07 17:48:50 UTC] ; stop_time=[n/a] ; pid=11031 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/zabbix_agentd ; argv[]=/usr/sbin/zabbix_agentd --foreground ; flags= ; start_time=[Sun 2025-12-07 17:48:50 UTC] ; stop_time=[n/a] ; pid=11031 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/zabbix-agent.service", "FreezerState": "running", "GID": "122", "Group": "zabbix", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "zabbix-agent.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sun 2025-12-07 17:48:50 UTC", "InactiveEnterTimestampMonotonic": "3434185071", "InactiveExitTimestamp": "Sun 2025-12-07 17:48:50 UTC", "InactiveExitTimestampMonotonic": "3434186357", "InvocationID": "96d03c98ba3142a08c60f4f0bffaae3e", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "11031", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "3518464", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "zabbix-agent.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2025-12-07 17:48:50 UTC", "StateChangeTimestampMonotonic": "3434186357", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "6", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "114", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "zabbix", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
changed: [web-2.ru-central1.internal] => {"changed": true, "enabled": true, "name": "zabbix-agent", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2025-12-07 17:48:50 UTC", "ActiveEnterTimestampMonotonic": "3435874463", "ActiveExitTimestamp": "Sun 2025-12-07 17:48:50 UTC", "ActiveExitTimestampMonotonic": "3435871369", "ActiveState": "active", "After": "systemd-journald.socket basic.target sysinit.target system.slice network.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2025-12-07 17:48:50 UTC", "AssertTimestampMonotonic": "3435873427", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "1033948000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2025-12-07 17:48:50 UTC", "ConditionTimestampMonotonic": "3435873426", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/zabbix-agent.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "Zabbix Agent", "DevicePolicy": "auto", "Documentation": "man:zabbix_agentd", "DynamicUser": "no", "EffectiveCPUs": "0-1", "EffectiveMemoryNodes": "0", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "11034", "ExecMainStartTimestamp": "Sun 2025-12-07 17:48:50 UTC", "ExecMainStartTimestampMonotonic": "3435874247", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/sbin/zabbix_agentd ; argv[]=/usr/sbin/zabbix_agentd --foreground ; ignore_errors=no ; start_time=[Sun 2025-12-07 17:48:50 UTC] ; stop_time=[n/a] ; pid=11034 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/zabbix_agentd ; argv[]=/usr/sbin/zabbix_agentd --foreground ; flags= ; start_time=[Sun 2025-12-07 17:48:50 UTC] ; stop_time=[n/a] ; pid=11034 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/zabbix-agent.service", "FreezerState": "running", "GID": "122", "Group": "zabbix", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "zabbix-agent.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sun 2025-12-07 17:48:50 UTC", "InactiveEnterTimestampMonotonic": "3435872991", "InactiveExitTimestamp": "Sun 2025-12-07 17:48:50 UTC", "InactiveExitTimestampMonotonic": "3435874463", "InvocationID": "9ca8a63139dc4717ae570e0b234d9cc6", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "11034", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "3547136", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "zabbix-agent.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2025-12-07 17:48:50 UTC", "StateChangeTimestampMonotonic": "3435874463", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "6", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "114", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "zabbix", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}

PLAY RECAP *********************************************************************
web-1.ru-central1.internal : ok=5    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
web-2.ru-central1.internal : ok=5    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   


5ï¸âƒ£  Deploying ELK stack
Using /home/ubuntu/ansible/ansible.cfg as config file

PLAY [Deploy ELK Stack (Elasticsearch, Kibana, Filebeat) via Docker] ***********

TASK [Gathering Facts] *********************************************************
ok: [web-1.ru-central1.internal]
ok: [elasticsearch.ru-central1.internal]
ok: [zabbix.ru-central1.internal]
ok: [web-2.ru-central1.internal]
ok: [kibana.ru-central1.internal]

TASK [Wait for system to be ready] *********************************************
ok: [web-1.ru-central1.internal] => {"changed": false, "elapsed": 0}
ok: [zabbix.ru-central1.internal] => {"changed": false, "elapsed": 0}
ok: [web-2.ru-central1.internal] => {"changed": false, "elapsed": 0}
ok: [elasticsearch.ru-central1.internal] => {"changed": false, "elapsed": 0}
ok: [kibana.ru-central1.internal] => {"changed": false, "elapsed": 0}

TASK [Start Elasticsearch container] *******************************************
skipping: [web-1.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
skipping: [web-2.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
skipping: [zabbix.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
skipping: [kibana.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
[DEPRECATION WARNING]: The container_default_behavior option will change its 
default value from "compatibility" to "no_defaults" in community.general 3.0.0.
 To remove this warning, please specify an explicit value for it now. This 
feature will be removed from community.general in version 3.0.0. Deprecation 
warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
ok: [elasticsearch.ru-central1.internal] => {"ansible_facts": {"docker_container": {"AppArmorProfile": "docker-default", "Args": ["--", "/usr/local/bin/docker-entrypoint.sh", "eswrapper"], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["eswrapper"], "Domainname": "", "Entrypoint": ["/bin/tini", "--", "/usr/local/bin/docker-entrypoint.sh"], "Env": ["discovery.type=single-node", "xpack.security.enabled=false", "ES_JAVA_OPTS=-Xms512m -Xmx512m", "PATH=/usr/share/elasticsearch/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "ELASTIC_CONTAINER=true", "SHELL=/bin/bash"], "ExposedPorts": {"9200/tcp": {}, "9300/tcp": {}}, "Hostname": "8888344bcbd2", "Image": "elastic/elasticsearch:8.19.6", "Labels": {"org.label-schema.build-date": "2025-10-21T22:05:27.062491219Z", "org.label-schema.license": "Elastic-License-2.0", "org.label-schema.name": "Elasticsearch", "org.label-schema.schema-version": "1.0", "org.label-schema.url": "https://www.elastic.co/products/elasticsearch", "org.label-schema.usage": "https://www.elastic.co/guide/en/elasticsearch/reference/index.html", "org.label-schema.vcs-ref": "d2c42d91a1eb9e14b1a37c4d87eb2533ec859e2b", "org.label-schema.vcs-url": "https://github.com/elastic/elasticsearch", "org.label-schema.vendor": "Elastic", "org.label-schema.version": "8.19.6", "org.opencontainers.image.created": "2025-10-21T22:05:27.062491219Z", "org.opencontainers.image.documentation": "https://www.elastic.co/guide/en/elasticsearch/reference/index.html", "org.opencontainers.image.licenses": "Elastic-License-2.0", "org.opencontainers.image.ref.name": "ubuntu", "org.opencontainers.image.revision": "d2c42d91a1eb9e14b1a37c4d87eb2533ec859e2b", "org.opencontainers.image.source": "https://github.com/elastic/elasticsearch", "org.opencontainers.image.title": "Elasticsearch", "org.opencontainers.image.url": "https://www.elastic.co/products/elasticsearch", "org.opencontainers.image.vendor": "Elastic", "org.opencontainers.image.version": "8.19.6"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "1000:0", "Volumes": null, "WorkingDir": "/usr/share/elasticsearch"}, "Created": "2025-12-07T18:40:15.83849528Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"ID": "8888344bcbd216f8e546bd5a53043d077f9ce8b879c2c40cb1910b925855aca9", "LowerDir": "/var/lib/docker/overlay2/ddb8416ba76db0a1516c1ae0ab620caa891a200859558234a5ff2e0be54c4bb1-init/diff:/var/lib/docker/overlay2/9f52a781e04777315cf8f2d1c3591469cd955d585a1e0d4a0e4ad5b0100ab0f8/diff:/var/lib/docker/overlay2/19c4ba83be23394549264cf09ca2fd8f797d038e9003892c78ebc80339f13be8/diff:/var/lib/docker/overlay2/f7ab6c4d016747ce209f865dbbd16e6fdb5f5a594c2fe6eabb7992096b519872/diff:/var/lib/docker/overlay2/cc44dd7abef5ba5ff3c02e55fa8d95cfa954671de0964d8ea91d1d637b002624/diff:/var/lib/docker/overlay2/2f10cadf3ba28942a8009a1789e378bf05c79e2c997ecc89efbd0467af48d1de/diff:/var/lib/docker/overlay2/dbd8dd36298de903c71543677c2301c01d246cad4c1ebdc0f85a9a5b99e0d0f4/diff:/var/lib/docker/overlay2/916a1fb9ac0e34e369e338467ca006b98d8d194ec0a4b6a19ea70a4f8a12a7ce/diff:/var/lib/docker/overlay2/c40e2cd7fc6b7927a1eb4700281c9e5e121575c5aea7dea3899bc2e07720d360/diff:/var/lib/docker/overlay2/52499f316ea127db8ce7c92a8bbf21e500e6a611102881c493cfc161e55cc0eb/diff:/var/lib/docker/overlay2/c4f8aadad82c47502c7e482a654a27bdc2b330d38116b0fda2707162f1df577f/diff", "MergedDir": "/var/lib/docker/overlay2/ddb8416ba76db0a1516c1ae0ab620caa891a200859558234a5ff2e0be54c4bb1/merged", "UpperDir": "/var/lib/docker/overlay2/ddb8416ba76db0a1516c1ae0ab620caa891a200859558234a5ff2e0be54c4bb1/diff", "WorkDir": "/var/lib/docker/overlay2/ddb8416ba76db0a1516c1ae0ab620caa891a200859558234a5ff2e0be54c4bb1/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": ["/opt/elasticsearch/data:/usr/share/elasticsearch/data:rw"], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Cgroup": "", "CgroupParent": "", "CgroupnsMode": "private", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": ["/proc/asound", "/proc/acpi", "/proc/interrupts", "/proc/kcore", "/proc/keys", "/proc/latency_stats", "/proc/timer_list", "/proc/timer_stats", "/proc/sched_debug", "/proc/scsi", "/sys/firmware", "/sys/devices/virtual/powercap"], "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "bridge", "OomKillDisable": null, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": {"9200/tcp": [{"HostIp": "0.0.0.0", "HostPort": "9200"}]}, "Privileged": false, "PublishAllPorts": false, "ReadonlyPaths": ["/proc/bus", "/proc/fs", "/proc/irq", "/proc/sys", "/proc/sysrq-trigger"], "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": "always"}, "Runtime": "runc", "SecurityOpt": null, "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/8888344bcbd216f8e546bd5a53043d077f9ce8b879c2c40cb1910b925855aca9/hostname", "HostsPath": "/var/lib/docker/containers/8888344bcbd216f8e546bd5a53043d077f9ce8b879c2c40cb1910b925855aca9/hosts", "Id": "8888344bcbd216f8e546bd5a53043d077f9ce8b879c2c40cb1910b925855aca9", "Image": "sha256:6d37afc10662a0fee7404f5e42499b9d8334ccecd56869dc6c2b2b176c2d821a", "LogPath": "/var/lib/docker/containers/8888344bcbd216f8e546bd5a53043d077f9ce8b879c2c40cb1910b925855aca9/8888344bcbd216f8e546bd5a53043d077f9ce8b879c2c40cb1910b925855aca9-json.log", "MountLabel": "", "Mounts": [{"Destination": "/usr/share/elasticsearch/data", "Mode": "rw", "Propagation": "rprivate", "RW": true, "Source": "/opt/elasticsearch/data", "Type": "bind"}], "Name": "/elasticsearch", "NetworkSettings": {"Bridge": "", "EndpointID": "dc5476cf69b460e75c856ff54698b2305206a5c99d9a94483f70e1e4141a597b", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:a5:d7:3c:79:60", "Networks": {"bridge": {"Aliases": null, "DNSNames": null, "DriverOpts": null, "EndpointID": "dc5476cf69b460e75c856ff54698b2305206a5c99d9a94483f70e1e4141a597b", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "GwPriority": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:a5:d7:3c:79:60", "NetworkID": "05295d2064b4b476f24bf4a9670cb21085c923abb6b5fdfe26974c17ca2365d6"}}, "Ports": {"9200/tcp": [{"HostIp": "0.0.0.0", "HostPort": "9200"}], "9300/tcp": null}, "SandboxID": "3aac6720383b98ee9e5f2b68ecdc7fc851603b099207807426100b0ac62f8217", "SandboxKey": "/var/run/docker/netns/3aac6720383b", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/bin/tini", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/8888344bcbd216f8e546bd5a53043d077f9ce8b879c2c40cb1910b925855aca9/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 6245, "Restarting": false, "Running": true, "StartedAt": "2025-12-07T18:40:22.354694044Z", "Status": "running"}}}, "changed": false, "container": {"AppArmorProfile": "docker-default", "Args": ["--", "/usr/local/bin/docker-entrypoint.sh", "eswrapper"], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["eswrapper"], "Domainname": "", "Entrypoint": ["/bin/tini", "--", "/usr/local/bin/docker-entrypoint.sh"], "Env": ["discovery.type=single-node", "xpack.security.enabled=false", "ES_JAVA_OPTS=-Xms512m -Xmx512m", "PATH=/usr/share/elasticsearch/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "ELASTIC_CONTAINER=true", "SHELL=/bin/bash"], "ExposedPorts": {"9200/tcp": {}, "9300/tcp": {}}, "Hostname": "8888344bcbd2", "Image": "elastic/elasticsearch:8.19.6", "Labels": {"org.label-schema.build-date": "2025-10-21T22:05:27.062491219Z", "org.label-schema.license": "Elastic-License-2.0", "org.label-schema.name": "Elasticsearch", "org.label-schema.schema-version": "1.0", "org.label-schema.url": "https://www.elastic.co/products/elasticsearch", "org.label-schema.usage": "https://www.elastic.co/guide/en/elasticsearch/reference/index.html", "org.label-schema.vcs-ref": "d2c42d91a1eb9e14b1a37c4d87eb2533ec859e2b", "org.label-schema.vcs-url": "https://github.com/elastic/elasticsearch", "org.label-schema.vendor": "Elastic", "org.label-schema.version": "8.19.6", "org.opencontainers.image.created": "2025-10-21T22:05:27.062491219Z", "org.opencontainers.image.documentation": "https://www.elastic.co/guide/en/elasticsearch/reference/index.html", "org.opencontainers.image.licenses": "Elastic-License-2.0", "org.opencontainers.image.ref.name": "ubuntu", "org.opencontainers.image.revision": "d2c42d91a1eb9e14b1a37c4d87eb2533ec859e2b", "org.opencontainers.image.source": "https://github.com/elastic/elasticsearch", "org.opencontainers.image.title": "Elasticsearch", "org.opencontainers.image.url": "https://www.elastic.co/products/elasticsearch", "org.opencontainers.image.vendor": "Elastic", "org.opencontainers.image.version": "8.19.6"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "1000:0", "Volumes": null, "WorkingDir": "/usr/share/elasticsearch"}, "Created": "2025-12-07T18:40:15.83849528Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"ID": "8888344bcbd216f8e546bd5a53043d077f9ce8b879c2c40cb1910b925855aca9", "LowerDir": "/var/lib/docker/overlay2/ddb8416ba76db0a1516c1ae0ab620caa891a200859558234a5ff2e0be54c4bb1-init/diff:/var/lib/docker/overlay2/9f52a781e04777315cf8f2d1c3591469cd955d585a1e0d4a0e4ad5b0100ab0f8/diff:/var/lib/docker/overlay2/19c4ba83be23394549264cf09ca2fd8f797d038e9003892c78ebc80339f13be8/diff:/var/lib/docker/overlay2/f7ab6c4d016747ce209f865dbbd16e6fdb5f5a594c2fe6eabb7992096b519872/diff:/var/lib/docker/overlay2/cc44dd7abef5ba5ff3c02e55fa8d95cfa954671de0964d8ea91d1d637b002624/diff:/var/lib/docker/overlay2/2f10cadf3ba28942a8009a1789e378bf05c79e2c997ecc89efbd0467af48d1de/diff:/var/lib/docker/overlay2/dbd8dd36298de903c71543677c2301c01d246cad4c1ebdc0f85a9a5b99e0d0f4/diff:/var/lib/docker/overlay2/916a1fb9ac0e34e369e338467ca006b98d8d194ec0a4b6a19ea70a4f8a12a7ce/diff:/var/lib/docker/overlay2/c40e2cd7fc6b7927a1eb4700281c9e5e121575c5aea7dea3899bc2e07720d360/diff:/var/lib/docker/overlay2/52499f316ea127db8ce7c92a8bbf21e500e6a611102881c493cfc161e55cc0eb/diff:/var/lib/docker/overlay2/c4f8aadad82c47502c7e482a654a27bdc2b330d38116b0fda2707162f1df577f/diff", "MergedDir": "/var/lib/docker/overlay2/ddb8416ba76db0a1516c1ae0ab620caa891a200859558234a5ff2e0be54c4bb1/merged", "UpperDir": "/var/lib/docker/overlay2/ddb8416ba76db0a1516c1ae0ab620caa891a200859558234a5ff2e0be54c4bb1/diff", "WorkDir": "/var/lib/docker/overlay2/ddb8416ba76db0a1516c1ae0ab620caa891a200859558234a5ff2e0be54c4bb1/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": ["/opt/elasticsearch/data:/usr/share/elasticsearch/data:rw"], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Cgroup": "", "CgroupParent": "", "CgroupnsMode": "private", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": ["/proc/asound", "/proc/acpi", "/proc/interrupts", "/proc/kcore", "/proc/keys", "/proc/latency_stats", "/proc/timer_list", "/proc/timer_stats", "/proc/sched_debug", "/proc/scsi", "/sys/firmware", "/sys/devices/virtual/powercap"], "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "bridge", "OomKillDisable": null, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": {"9200/tcp": [{"HostIp": "0.0.0.0", "HostPort": "9200"}]}, "Privileged": false, "PublishAllPorts": false, "ReadonlyPaths": ["/proc/bus", "/proc/fs", "/proc/irq", "/proc/sys", "/proc/sysrq-trigger"], "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": "always"}, "Runtime": "runc", "SecurityOpt": null, "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/8888344bcbd216f8e546bd5a53043d077f9ce8b879c2c40cb1910b925855aca9/hostname", "HostsPath": "/var/lib/docker/containers/8888344bcbd216f8e546bd5a53043d077f9ce8b879c2c40cb1910b925855aca9/hosts", "Id": "8888344bcbd216f8e546bd5a53043d077f9ce8b879c2c40cb1910b925855aca9", "Image": "sha256:6d37afc10662a0fee7404f5e42499b9d8334ccecd56869dc6c2b2b176c2d821a", "LogPath": "/var/lib/docker/containers/8888344bcbd216f8e546bd5a53043d077f9ce8b879c2c40cb1910b925855aca9/8888344bcbd216f8e546bd5a53043d077f9ce8b879c2c40cb1910b925855aca9-json.log", "MountLabel": "", "Mounts": [{"Destination": "/usr/share/elasticsearch/data", "Mode": "rw", "Propagation": "rprivate", "RW": true, "Source": "/opt/elasticsearch/data", "Type": "bind"}], "Name": "/elasticsearch", "NetworkSettings": {"Bridge": "", "EndpointID": "dc5476cf69b460e75c856ff54698b2305206a5c99d9a94483f70e1e4141a597b", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "02:a5:d7:3c:79:60", "Networks": {"bridge": {"Aliases": null, "DNSNames": null, "DriverOpts": null, "EndpointID": "dc5476cf69b460e75c856ff54698b2305206a5c99d9a94483f70e1e4141a597b", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "GwPriority": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "02:a5:d7:3c:79:60", "NetworkID": "05295d2064b4b476f24bf4a9670cb21085c923abb6b5fdfe26974c17ca2365d6"}}, "Ports": {"9200/tcp": [{"HostIp": "0.0.0.0", "HostPort": "9200"}], "9300/tcp": null}, "SandboxID": "3aac6720383b98ee9e5f2b68ecdc7fc851603b099207807426100b0ac62f8217", "SandboxKey": "/var/run/docker/netns/3aac6720383b", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/bin/tini", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/8888344bcbd216f8e546bd5a53043d077f9ce8b879c2c40cb1910b925855aca9/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 6245, "Restarting": false, "Running": true, "StartedAt": "2025-12-07T18:40:22.354694044Z", "Status": "running"}}}

TASK [Set vm.max_map_count for Elasticsearch] **********************************
skipping: [web-1.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
skipping: [web-2.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
skipping: [kibana.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
skipping: [zabbix.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
ok: [elasticsearch.ru-central1.internal] => {"changed": false}

TASK [Start Kibana container] **************************************************
skipping: [web-1.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
skipping: [web-2.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
skipping: [elasticsearch.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
skipping: [zabbix.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
ok: [kibana.ru-central1.internal] => {"ansible_facts": {"docker_container": {"AppArmorProfile": "docker-default", "Args": ["--", "/usr/local/bin/kibana-docker"], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/local/bin/kibana-docker"], "Domainname": "", "Entrypoint": ["/bin/tini", "--"], "Env": ["ELASTICSEARCH_HOSTS=http://192.168.20.9:9200", "SERVER_HOST=0.0.0.0", "SERVER_NAME=kibana", "PATH=/usr/share/kibana/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "ELASTIC_CONTAINER=true"], "ExposedPorts": {"5601/tcp": {}}, "Hostname": "97c5bbb11e0f", "Image": "elastic/kibana:8.19.6", "Labels": {"org.label-schema.build-date": "2025-10-21T20:18:24.484Z", "org.label-schema.license": "Elastic License", "org.label-schema.name": "Kibana", "org.label-schema.schema-version": "1.0", "org.label-schema.url": "https://www.elastic.co/products/kibana", "org.label-schema.usage": "https://www.elastic.co/guide/en/kibana/reference/index.html", "org.label-schema.vcs-ref": "93caa41bf1dca66c8754156cd7819e2ceb980455", "org.label-schema.vcs-url": "https://github.com/elastic/kibana", "org.label-schema.vendor": "Elastic", "org.label-schema.version": "8.19.6", "org.opencontainers.image.created": "2025-10-21T20:18:24.484Z", "org.opencontainers.image.documentation": "https://www.elastic.co/guide/en/kibana/reference/index.html", "org.opencontainers.image.licenses": "Elastic License", "org.opencontainers.image.ref.name": "ubuntu", "org.opencontainers.image.revision": "93caa41bf1dca66c8754156cd7819e2ceb980455", "org.opencontainers.image.source": "https://github.com/elastic/kibana", "org.opencontainers.image.title": "Kibana", "org.opencontainers.image.url": "https://www.elastic.co/products/kibana", "org.opencontainers.image.vendor": "Elastic", "org.opencontainers.image.version": "8.19.6"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "1000", "Volumes": null, "WorkingDir": "/usr/share/kibana"}, "Created": "2025-12-07T18:41:35.185853574Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"ID": "97c5bbb11e0f3d6286438d6a6b420ef8825d69a01171b58f32e11034092ce6ed", "LowerDir": "/var/lib/docker/overlay2/86fff79ff7fde490f00d77fec443d7953bdbe67d04608b9b7e7cfb15cdb1ff39-init/diff:/var/lib/docker/overlay2/be77aeb2ea29d9c58380a02f7525e871319b89b59f9713108242b07e142e10c8/diff:/var/lib/docker/overlay2/6f51b5a9f1666f6279476a52265808cbb3d9f89b1c81e940a2494f6e492b7dad/diff:/var/lib/docker/overlay2/325e84615b1f27c29d2f0fd73e4db4501af3ead8507e24b3fe2074845be3ee37/diff:/var/lib/docker/overlay2/d8805b24554b6c25b518c1cc52aab76e247fd7d8b5a4177674bfe79a1b3f5b79/diff:/var/lib/docker/overlay2/6c24b270aea25b887867ffd50627f7f8fff6925acb3d1b11c0273893127eb178/diff:/var/lib/docker/overlay2/69da96d6c2bbfbf123188199f8abf432cd3d90115590d0d1996af5274a69c76b/diff:/var/lib/docker/overlay2/a66b04a72b7ef15d16d8f004eebbd4ef3d423d680f3d8e6bd98e91042b4cd168/diff:/var/lib/docker/overlay2/4c6519f582338cefe94f8ea4a8eafdf10945daa2d216fae35a302f6fa0dd695b/diff:/var/lib/docker/overlay2/cdc5704cb5ddf7b794c59f749d207b93a23c54030aaaf0a991424028fd39546b/diff:/var/lib/docker/overlay2/87c4093d8af50632766cde2eb1888756eab883a539c28ab5f00a52d1ae408041/diff:/var/lib/docker/overlay2/713298f9f8f157a56f9dc8783921e1dc806b2c2c39e6f7671d8874f1102ce9d7/diff:/var/lib/docker/overlay2/fec06b19d5d1122525ef4bae633ea6f53ffaa810ce3d6b0c34d3adadef353d50/diff:/var/lib/docker/overlay2/77cf1ad59dcaadbda3f6cd159aa817cabd7979de7a24c05477e87e87b9dd51dc/diff", "MergedDir": "/var/lib/docker/overlay2/86fff79ff7fde490f00d77fec443d7953bdbe67d04608b9b7e7cfb15cdb1ff39/merged", "UpperDir": "/var/lib/docker/overlay2/86fff79ff7fde490f00d77fec443d7953bdbe67d04608b9b7e7cfb15cdb1ff39/diff", "WorkDir": "/var/lib/docker/overlay2/86fff79ff7fde490f00d77fec443d7953bdbe67d04608b9b7e7cfb15cdb1ff39/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Cgroup": "", "CgroupParent": "", "CgroupnsMode": "private", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": ["/proc/asound", "/proc/acpi", "/proc/interrupts", "/proc/kcore", "/proc/keys", "/proc/latency_stats", "/proc/timer_list", "/proc/timer_stats", "/proc/sched_debug", "/proc/scsi", "/sys/firmware", "/sys/devices/virtual/powercap"], "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "bridge", "OomKillDisable": null, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": {"5601/tcp": [{"HostIp": "0.0.0.0", "HostPort": "5601"}]}, "Privileged": false, "PublishAllPorts": false, "ReadonlyPaths": ["/proc/bus", "/proc/fs", "/proc/irq", "/proc/sys", "/proc/sysrq-trigger"], "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": "always"}, "Runtime": "runc", "SecurityOpt": null, "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/97c5bbb11e0f3d6286438d6a6b420ef8825d69a01171b58f32e11034092ce6ed/hostname", "HostsPath": "/var/lib/docker/containers/97c5bbb11e0f3d6286438d6a6b420ef8825d69a01171b58f32e11034092ce6ed/hosts", "Id": "97c5bbb11e0f3d6286438d6a6b420ef8825d69a01171b58f32e11034092ce6ed", "Image": "sha256:58cc17752a3310cda6a81885228f85ad5c554369f98010bdd0a1e70f5eccada6", "LogPath": "/var/lib/docker/containers/97c5bbb11e0f3d6286438d6a6b420ef8825d69a01171b58f32e11034092ce6ed/97c5bbb11e0f3d6286438d6a6b420ef8825d69a01171b58f32e11034092ce6ed-json.log", "MountLabel": "", "Mounts": [], "Name": "/kibana", "NetworkSettings": {"Bridge": "", "EndpointID": "d8777fd3a38d57b7344e19f83f49d65dcecbc0b0838ffbb84bec45c0aead2820", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "66:83:53:f0:75:7f", "Networks": {"bridge": {"Aliases": null, "DNSNames": null, "DriverOpts": null, "EndpointID": "d8777fd3a38d57b7344e19f83f49d65dcecbc0b0838ffbb84bec45c0aead2820", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "GwPriority": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "66:83:53:f0:75:7f", "NetworkID": "47824b2e6b51a2fcaa80fbf868d223e8c21d34e3ab19644730bdc93002c04919"}}, "Ports": {"5601/tcp": [{"HostIp": "0.0.0.0", "HostPort": "5601"}]}, "SandboxID": "b20b0de377f9c8cb4238f0b2fc3e5c642db9126a3628f386ccd9e9ae53e93b04", "SandboxKey": "/var/run/docker/netns/b20b0de377f9", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/bin/tini", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/97c5bbb11e0f3d6286438d6a6b420ef8825d69a01171b58f32e11034092ce6ed/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 10174, "Restarting": false, "Running": true, "StartedAt": "2025-12-07T18:41:35.456706677Z", "Status": "running"}}}, "changed": false, "container": {"AppArmorProfile": "docker-default", "Args": ["--", "/usr/local/bin/kibana-docker"], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["/usr/local/bin/kibana-docker"], "Domainname": "", "Entrypoint": ["/bin/tini", "--"], "Env": ["ELASTICSEARCH_HOSTS=http://192.168.20.9:9200", "SERVER_HOST=0.0.0.0", "SERVER_NAME=kibana", "PATH=/usr/share/kibana/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "ELASTIC_CONTAINER=true"], "ExposedPorts": {"5601/tcp": {}}, "Hostname": "97c5bbb11e0f", "Image": "elastic/kibana:8.19.6", "Labels": {"org.label-schema.build-date": "2025-10-21T20:18:24.484Z", "org.label-schema.license": "Elastic License", "org.label-schema.name": "Kibana", "org.label-schema.schema-version": "1.0", "org.label-schema.url": "https://www.elastic.co/products/kibana", "org.label-schema.usage": "https://www.elastic.co/guide/en/kibana/reference/index.html", "org.label-schema.vcs-ref": "93caa41bf1dca66c8754156cd7819e2ceb980455", "org.label-schema.vcs-url": "https://github.com/elastic/kibana", "org.label-schema.vendor": "Elastic", "org.label-schema.version": "8.19.6", "org.opencontainers.image.created": "2025-10-21T20:18:24.484Z", "org.opencontainers.image.documentation": "https://www.elastic.co/guide/en/kibana/reference/index.html", "org.opencontainers.image.licenses": "Elastic License", "org.opencontainers.image.ref.name": "ubuntu", "org.opencontainers.image.revision": "93caa41bf1dca66c8754156cd7819e2ceb980455", "org.opencontainers.image.source": "https://github.com/elastic/kibana", "org.opencontainers.image.title": "Kibana", "org.opencontainers.image.url": "https://www.elastic.co/products/kibana", "org.opencontainers.image.vendor": "Elastic", "org.opencontainers.image.version": "8.19.6"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "1000", "Volumes": null, "WorkingDir": "/usr/share/kibana"}, "Created": "2025-12-07T18:41:35.185853574Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"ID": "97c5bbb11e0f3d6286438d6a6b420ef8825d69a01171b58f32e11034092ce6ed", "LowerDir": "/var/lib/docker/overlay2/86fff79ff7fde490f00d77fec443d7953bdbe67d04608b9b7e7cfb15cdb1ff39-init/diff:/var/lib/docker/overlay2/be77aeb2ea29d9c58380a02f7525e871319b89b59f9713108242b07e142e10c8/diff:/var/lib/docker/overlay2/6f51b5a9f1666f6279476a52265808cbb3d9f89b1c81e940a2494f6e492b7dad/diff:/var/lib/docker/overlay2/325e84615b1f27c29d2f0fd73e4db4501af3ead8507e24b3fe2074845be3ee37/diff:/var/lib/docker/overlay2/d8805b24554b6c25b518c1cc52aab76e247fd7d8b5a4177674bfe79a1b3f5b79/diff:/var/lib/docker/overlay2/6c24b270aea25b887867ffd50627f7f8fff6925acb3d1b11c0273893127eb178/diff:/var/lib/docker/overlay2/69da96d6c2bbfbf123188199f8abf432cd3d90115590d0d1996af5274a69c76b/diff:/var/lib/docker/overlay2/a66b04a72b7ef15d16d8f004eebbd4ef3d423d680f3d8e6bd98e91042b4cd168/diff:/var/lib/docker/overlay2/4c6519f582338cefe94f8ea4a8eafdf10945daa2d216fae35a302f6fa0dd695b/diff:/var/lib/docker/overlay2/cdc5704cb5ddf7b794c59f749d207b93a23c54030aaaf0a991424028fd39546b/diff:/var/lib/docker/overlay2/87c4093d8af50632766cde2eb1888756eab883a539c28ab5f00a52d1ae408041/diff:/var/lib/docker/overlay2/713298f9f8f157a56f9dc8783921e1dc806b2c2c39e6f7671d8874f1102ce9d7/diff:/var/lib/docker/overlay2/fec06b19d5d1122525ef4bae633ea6f53ffaa810ce3d6b0c34d3adadef353d50/diff:/var/lib/docker/overlay2/77cf1ad59dcaadbda3f6cd159aa817cabd7979de7a24c05477e87e87b9dd51dc/diff", "MergedDir": "/var/lib/docker/overlay2/86fff79ff7fde490f00d77fec443d7953bdbe67d04608b9b7e7cfb15cdb1ff39/merged", "UpperDir": "/var/lib/docker/overlay2/86fff79ff7fde490f00d77fec443d7953bdbe67d04608b9b7e7cfb15cdb1ff39/diff", "WorkDir": "/var/lib/docker/overlay2/86fff79ff7fde490f00d77fec443d7953bdbe67d04608b9b7e7cfb15cdb1ff39/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": [], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Cgroup": "", "CgroupParent": "", "CgroupnsMode": "private", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": ["/proc/asound", "/proc/acpi", "/proc/interrupts", "/proc/kcore", "/proc/keys", "/proc/latency_stats", "/proc/timer_list", "/proc/timer_stats", "/proc/sched_debug", "/proc/scsi", "/sys/firmware", "/sys/devices/virtual/powercap"], "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "bridge", "OomKillDisable": null, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": {"5601/tcp": [{"HostIp": "0.0.0.0", "HostPort": "5601"}]}, "Privileged": false, "PublishAllPorts": false, "ReadonlyPaths": ["/proc/bus", "/proc/fs", "/proc/irq", "/proc/sys", "/proc/sysrq-trigger"], "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": "always"}, "Runtime": "runc", "SecurityOpt": null, "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/97c5bbb11e0f3d6286438d6a6b420ef8825d69a01171b58f32e11034092ce6ed/hostname", "HostsPath": "/var/lib/docker/containers/97c5bbb11e0f3d6286438d6a6b420ef8825d69a01171b58f32e11034092ce6ed/hosts", "Id": "97c5bbb11e0f3d6286438d6a6b420ef8825d69a01171b58f32e11034092ce6ed", "Image": "sha256:58cc17752a3310cda6a81885228f85ad5c554369f98010bdd0a1e70f5eccada6", "LogPath": "/var/lib/docker/containers/97c5bbb11e0f3d6286438d6a6b420ef8825d69a01171b58f32e11034092ce6ed/97c5bbb11e0f3d6286438d6a6b420ef8825d69a01171b58f32e11034092ce6ed-json.log", "MountLabel": "", "Mounts": [], "Name": "/kibana", "NetworkSettings": {"Bridge": "", "EndpointID": "d8777fd3a38d57b7344e19f83f49d65dcecbc0b0838ffbb84bec45c0aead2820", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "66:83:53:f0:75:7f", "Networks": {"bridge": {"Aliases": null, "DNSNames": null, "DriverOpts": null, "EndpointID": "d8777fd3a38d57b7344e19f83f49d65dcecbc0b0838ffbb84bec45c0aead2820", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "GwPriority": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "66:83:53:f0:75:7f", "NetworkID": "47824b2e6b51a2fcaa80fbf868d223e8c21d34e3ab19644730bdc93002c04919"}}, "Ports": {"5601/tcp": [{"HostIp": "0.0.0.0", "HostPort": "5601"}]}, "SandboxID": "b20b0de377f9c8cb4238f0b2fc3e5c642db9126a3628f386ccd9e9ae53e93b04", "SandboxKey": "/var/run/docker/netns/b20b0de377f9", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/bin/tini", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/97c5bbb11e0f3d6286438d6a6b420ef8825d69a01171b58f32e11034092ce6ed/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 10174, "Restarting": false, "Running": true, "StartedAt": "2025-12-07T18:41:35.456706677Z", "Status": "running"}}}

TASK [Create Filebeat config directory] ****************************************
skipping: [elasticsearch.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
skipping: [zabbix.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
skipping: [kibana.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
ok: [web-1.ru-central1.internal] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/etc/filebeat", "size": 4096, "state": "directory", "uid": 0}
ok: [web-2.ru-central1.internal] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/etc/filebeat", "size": 4096, "state": "directory", "uid": 0}

TASK [Create Filebeat configuration file] **************************************
skipping: [elasticsearch.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
skipping: [zabbix.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
skipping: [kibana.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
ok: [web-1.ru-central1.internal] => {"changed": false, "checksum": "f4ea913361bac1cdf78b011f30a76ef908aa8992", "dest": "/etc/filebeat/filebeat.yml", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/filebeat/filebeat.yml", "size": 286, "state": "file", "uid": 0}
ok: [web-2.ru-central1.internal] => {"changed": false, "checksum": "f4ea913361bac1cdf78b011f30a76ef908aa8992", "dest": "/etc/filebeat/filebeat.yml", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/filebeat/filebeat.yml", "size": 286, "state": "file", "uid": 0}

TASK [Start Filebeat container] ************************************************
skipping: [elasticsearch.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
skipping: [zabbix.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
skipping: [kibana.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
ok: [web-1.ru-central1.internal] => {"ansible_facts": {"docker_container": {"AppArmorProfile": "docker-default", "Args": ["--", "/usr/local/bin/docker-entrypoint", "--environment", "container"], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["--environment", "container"], "Domainname": "", "Entrypoint": ["/usr/bin/tini", "--", "/usr/local/bin/docker-entrypoint"], "Env": ["PATH=/usr/share/filebeat:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "ELASTIC_CONTAINER=true", "GODEBUG=madvdontneed=1", "LIBBEAT_MONITORING_CGROUPS_HIERARCHY_OVERRIDE=/"], "Hostname": "6b8462479570", "Image": "elastic/filebeat:8.19.6", "Labels": {"description": "Filebeat sends log files to Logstash or directly to Elasticsearch.", "io.k8s.description": "Filebeat sends log files to Logstash or directly to Elasticsearch.", "io.k8s.display-name": "Filebeat image", "license": "Elastic License", "maintainer": "infra@elastic.co", "name": "filebeat", "org.label-schema.build-date": "2025-10-21T18:51:53Z", "org.label-schema.license": "Elastic License", "org.label-schema.name": "filebeat", "org.label-schema.schema-version": "1.0", "org.label-schema.url": "https://www.elastic.co/beats/filebeat", "org.label-schema.vcs-ref": "ac8655385a99413beadaa6ef2447a1203fcb84d8", "org.label-schema.vcs-url": "github.com/elastic/beats/v7", "org.label-schema.vendor": "Elastic", "org.label-schema.version": "8.19.6", "org.opencontainers.image.authors": "infra@elastic.co", "org.opencontainers.image.created": "2025-10-21T18:51:53Z", "org.opencontainers.image.licenses": "Elastic License", "org.opencontainers.image.ref.name": "ubuntu", "org.opencontainers.image.title": "Filebeat", "org.opencontainers.image.vendor": "Elastic", "org.opencontainers.image.version": "24.04", "release": "1", "summary": "filebeat", "url": "https://www.elastic.co/beats/filebeat", "vendor": "Elastic", "version": "8.19.6"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "root", "Volumes": null, "WorkingDir": "/usr/share/filebeat"}, "Created": "2025-12-07T18:41:38.411417535Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"ID": "6b84624795708f94f1ab4a9ae5bb3968ee4f420026051eda574aef82894dd381", "LowerDir": "/var/lib/docker/overlay2/d33d009b55eff991b7899b6498b7a19f967b4878c2950bce7a94ce8945201112-init/diff:/var/lib/docker/overlay2/389e542fe8e10201f1ad97751e6293e23d19daee56d3d399364d3c9278e742d4/diff:/var/lib/docker/overlay2/afe29707218dbb99e0618a29e5de4fe0e99122a65934b2c1fc4bd77509cbdf08/diff:/var/lib/docker/overlay2/22d2f3f3a13c8909cf5992778fa9e86fc421969f56064e6652aad9b9fec14dc0/diff:/var/lib/docker/overlay2/f40ff05caf66f522eddc63b670becc2bb897fc6a7959468b8ee7fe9284bdabbd/diff:/var/lib/docker/overlay2/6cb46f34d69072c56ee50dcd5b5c096a4694953f5d85cb50a0b019074472e889/diff:/var/lib/docker/overlay2/8d14c818f9beee18f19cf99947ac83ad32962ad5fd6d260388c5e2a79df3fbfc/diff:/var/lib/docker/overlay2/7e5bd4e9504ffbffff6a1ce94cbc01cebe45e45afe14d46a9af917be86965bbc/diff:/var/lib/docker/overlay2/d7753b13cd360b8c21b0709c76f9f7312705c931bbe7e6472958703ea6cc1c8e/diff:/var/lib/docker/overlay2/0ca6080d95498f0d93ebe35b860e5718e2460084de781b265b4f985bbe9d71b6/diff:/var/lib/docker/overlay2/10d3a2d55365476da6279370179f5269c2382e0f204e581126d31307a7b45435/diff:/var/lib/docker/overlay2/6b6edb2792582cc46e57cfe0e61684f8de3f3c2043b5ef0b60522f4e5d42ca7b/diff:/var/lib/docker/overlay2/49bfd2511880d294c3d53fb18a1bc8e38b98e393742868a82b67fffb76b5cb0e/diff:/var/lib/docker/overlay2/f373cab74bacb46cb6cff0dfb85e34dba67da6cb4efc1f9a9e5bee91af2780f9/diff:/var/lib/docker/overlay2/38e38f50c0c3be32c77f97d20ba99eaa10ff21e6d3a8ea845e687f943c596f34/diff", "MergedDir": "/var/lib/docker/overlay2/d33d009b55eff991b7899b6498b7a19f967b4878c2950bce7a94ce8945201112/merged", "UpperDir": "/var/lib/docker/overlay2/d33d009b55eff991b7899b6498b7a19f967b4878c2950bce7a94ce8945201112/diff", "WorkDir": "/var/lib/docker/overlay2/d33d009b55eff991b7899b6498b7a19f967b4878c2950bce7a94ce8945201112/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": ["/var/log/nginx:/var/log/nginx:ro", "/etc/filebeat/filebeat.yml:/usr/share/filebeat/filebeat.yml:ro"], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Cgroup": "", "CgroupParent": "", "CgroupnsMode": "private", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": ["/proc/asound", "/proc/acpi", "/proc/interrupts", "/proc/kcore", "/proc/keys", "/proc/latency_stats", "/proc/timer_list", "/proc/timer_stats", "/proc/sched_debug", "/proc/scsi", "/sys/firmware", "/sys/devices/virtual/powercap"], "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "bridge", "OomKillDisable": null, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": false, "PublishAllPorts": false, "ReadonlyPaths": ["/proc/bus", "/proc/fs", "/proc/irq", "/proc/sys", "/proc/sysrq-trigger"], "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": "always"}, "Runtime": "runc", "SecurityOpt": null, "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/6b84624795708f94f1ab4a9ae5bb3968ee4f420026051eda574aef82894dd381/hostname", "HostsPath": "/var/lib/docker/containers/6b84624795708f94f1ab4a9ae5bb3968ee4f420026051eda574aef82894dd381/hosts", "Id": "6b84624795708f94f1ab4a9ae5bb3968ee4f420026051eda574aef82894dd381", "Image": "sha256:ad91d8c153111847623d7c8b3d4f2498655ecd1984b4e39571e213ce22d0a5a7", "LogPath": "/var/lib/docker/containers/6b84624795708f94f1ab4a9ae5bb3968ee4f420026051eda574aef82894dd381/6b84624795708f94f1ab4a9ae5bb3968ee4f420026051eda574aef82894dd381-json.log", "MountLabel": "", "Mounts": [{"Destination": "/var/log/nginx", "Mode": "ro", "Propagation": "rprivate", "RW": false, "Source": "/var/log/nginx", "Type": "bind"}, {"Destination": "/usr/share/filebeat/filebeat.yml", "Mode": "ro", "Propagation": "rprivate", "RW": false, "Source": "/etc/filebeat/filebeat.yml", "Type": "bind"}], "Name": "/filebeat", "NetworkSettings": {"Bridge": "", "EndpointID": "6f6e1a76f5d40efe0f29a1750343e65290bbe8483ec8ffe82c56f032812e318e", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "fa:e1:7c:2c:e0:45", "Networks": {"bridge": {"Aliases": null, "DNSNames": null, "DriverOpts": null, "EndpointID": "6f6e1a76f5d40efe0f29a1750343e65290bbe8483ec8ffe82c56f032812e318e", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "GwPriority": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "fa:e1:7c:2c:e0:45", "NetworkID": "3b5df64d0c54a2c576a800e4a524d146f099bd86433efcea0c4faae063dceea7"}}, "Ports": {}, "SandboxID": "04d816894c26d0a25d4b0e19cd0db89a6aeaf764023bf5d85eeb9f65064f7dc7", "SandboxKey": "/var/run/docker/netns/04d816894c26", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/bin/tini", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/6b84624795708f94f1ab4a9ae5bb3968ee4f420026051eda574aef82894dd381/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 12699, "Restarting": false, "Running": true, "StartedAt": "2025-12-07T18:41:38.523791512Z", "Status": "running"}}}, "changed": false, "container": {"AppArmorProfile": "docker-default", "Args": ["--", "/usr/local/bin/docker-entrypoint", "--environment", "container"], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["--environment", "container"], "Domainname": "", "Entrypoint": ["/usr/bin/tini", "--", "/usr/local/bin/docker-entrypoint"], "Env": ["PATH=/usr/share/filebeat:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "ELASTIC_CONTAINER=true", "GODEBUG=madvdontneed=1", "LIBBEAT_MONITORING_CGROUPS_HIERARCHY_OVERRIDE=/"], "Hostname": "6b8462479570", "Image": "elastic/filebeat:8.19.6", "Labels": {"description": "Filebeat sends log files to Logstash or directly to Elasticsearch.", "io.k8s.description": "Filebeat sends log files to Logstash or directly to Elasticsearch.", "io.k8s.display-name": "Filebeat image", "license": "Elastic License", "maintainer": "infra@elastic.co", "name": "filebeat", "org.label-schema.build-date": "2025-10-21T18:51:53Z", "org.label-schema.license": "Elastic License", "org.label-schema.name": "filebeat", "org.label-schema.schema-version": "1.0", "org.label-schema.url": "https://www.elastic.co/beats/filebeat", "org.label-schema.vcs-ref": "ac8655385a99413beadaa6ef2447a1203fcb84d8", "org.label-schema.vcs-url": "github.com/elastic/beats/v7", "org.label-schema.vendor": "Elastic", "org.label-schema.version": "8.19.6", "org.opencontainers.image.authors": "infra@elastic.co", "org.opencontainers.image.created": "2025-10-21T18:51:53Z", "org.opencontainers.image.licenses": "Elastic License", "org.opencontainers.image.ref.name": "ubuntu", "org.opencontainers.image.title": "Filebeat", "org.opencontainers.image.vendor": "Elastic", "org.opencontainers.image.version": "24.04", "release": "1", "summary": "filebeat", "url": "https://www.elastic.co/beats/filebeat", "vendor": "Elastic", "version": "8.19.6"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "root", "Volumes": null, "WorkingDir": "/usr/share/filebeat"}, "Created": "2025-12-07T18:41:38.411417535Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"ID": "6b84624795708f94f1ab4a9ae5bb3968ee4f420026051eda574aef82894dd381", "LowerDir": "/var/lib/docker/overlay2/d33d009b55eff991b7899b6498b7a19f967b4878c2950bce7a94ce8945201112-init/diff:/var/lib/docker/overlay2/389e542fe8e10201f1ad97751e6293e23d19daee56d3d399364d3c9278e742d4/diff:/var/lib/docker/overlay2/afe29707218dbb99e0618a29e5de4fe0e99122a65934b2c1fc4bd77509cbdf08/diff:/var/lib/docker/overlay2/22d2f3f3a13c8909cf5992778fa9e86fc421969f56064e6652aad9b9fec14dc0/diff:/var/lib/docker/overlay2/f40ff05caf66f522eddc63b670becc2bb897fc6a7959468b8ee7fe9284bdabbd/diff:/var/lib/docker/overlay2/6cb46f34d69072c56ee50dcd5b5c096a4694953f5d85cb50a0b019074472e889/diff:/var/lib/docker/overlay2/8d14c818f9beee18f19cf99947ac83ad32962ad5fd6d260388c5e2a79df3fbfc/diff:/var/lib/docker/overlay2/7e5bd4e9504ffbffff6a1ce94cbc01cebe45e45afe14d46a9af917be86965bbc/diff:/var/lib/docker/overlay2/d7753b13cd360b8c21b0709c76f9f7312705c931bbe7e6472958703ea6cc1c8e/diff:/var/lib/docker/overlay2/0ca6080d95498f0d93ebe35b860e5718e2460084de781b265b4f985bbe9d71b6/diff:/var/lib/docker/overlay2/10d3a2d55365476da6279370179f5269c2382e0f204e581126d31307a7b45435/diff:/var/lib/docker/overlay2/6b6edb2792582cc46e57cfe0e61684f8de3f3c2043b5ef0b60522f4e5d42ca7b/diff:/var/lib/docker/overlay2/49bfd2511880d294c3d53fb18a1bc8e38b98e393742868a82b67fffb76b5cb0e/diff:/var/lib/docker/overlay2/f373cab74bacb46cb6cff0dfb85e34dba67da6cb4efc1f9a9e5bee91af2780f9/diff:/var/lib/docker/overlay2/38e38f50c0c3be32c77f97d20ba99eaa10ff21e6d3a8ea845e687f943c596f34/diff", "MergedDir": "/var/lib/docker/overlay2/d33d009b55eff991b7899b6498b7a19f967b4878c2950bce7a94ce8945201112/merged", "UpperDir": "/var/lib/docker/overlay2/d33d009b55eff991b7899b6498b7a19f967b4878c2950bce7a94ce8945201112/diff", "WorkDir": "/var/lib/docker/overlay2/d33d009b55eff991b7899b6498b7a19f967b4878c2950bce7a94ce8945201112/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": ["/var/log/nginx:/var/log/nginx:ro", "/etc/filebeat/filebeat.yml:/usr/share/filebeat/filebeat.yml:ro"], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Cgroup": "", "CgroupParent": "", "CgroupnsMode": "private", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": ["/proc/asound", "/proc/acpi", "/proc/interrupts", "/proc/kcore", "/proc/keys", "/proc/latency_stats", "/proc/timer_list", "/proc/timer_stats", "/proc/sched_debug", "/proc/scsi", "/sys/firmware", "/sys/devices/virtual/powercap"], "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "bridge", "OomKillDisable": null, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": false, "PublishAllPorts": false, "ReadonlyPaths": ["/proc/bus", "/proc/fs", "/proc/irq", "/proc/sys", "/proc/sysrq-trigger"], "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": "always"}, "Runtime": "runc", "SecurityOpt": null, "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/6b84624795708f94f1ab4a9ae5bb3968ee4f420026051eda574aef82894dd381/hostname", "HostsPath": "/var/lib/docker/containers/6b84624795708f94f1ab4a9ae5bb3968ee4f420026051eda574aef82894dd381/hosts", "Id": "6b84624795708f94f1ab4a9ae5bb3968ee4f420026051eda574aef82894dd381", "Image": "sha256:ad91d8c153111847623d7c8b3d4f2498655ecd1984b4e39571e213ce22d0a5a7", "LogPath": "/var/lib/docker/containers/6b84624795708f94f1ab4a9ae5bb3968ee4f420026051eda574aef82894dd381/6b84624795708f94f1ab4a9ae5bb3968ee4f420026051eda574aef82894dd381-json.log", "MountLabel": "", "Mounts": [{"Destination": "/var/log/nginx", "Mode": "ro", "Propagation": "rprivate", "RW": false, "Source": "/var/log/nginx", "Type": "bind"}, {"Destination": "/usr/share/filebeat/filebeat.yml", "Mode": "ro", "Propagation": "rprivate", "RW": false, "Source": "/etc/filebeat/filebeat.yml", "Type": "bind"}], "Name": "/filebeat", "NetworkSettings": {"Bridge": "", "EndpointID": "6f6e1a76f5d40efe0f29a1750343e65290bbe8483ec8ffe82c56f032812e318e", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "fa:e1:7c:2c:e0:45", "Networks": {"bridge": {"Aliases": null, "DNSNames": null, "DriverOpts": null, "EndpointID": "6f6e1a76f5d40efe0f29a1750343e65290bbe8483ec8ffe82c56f032812e318e", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "GwPriority": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "fa:e1:7c:2c:e0:45", "NetworkID": "3b5df64d0c54a2c576a800e4a524d146f099bd86433efcea0c4faae063dceea7"}}, "Ports": {}, "SandboxID": "04d816894c26d0a25d4b0e19cd0db89a6aeaf764023bf5d85eeb9f65064f7dc7", "SandboxKey": "/var/run/docker/netns/04d816894c26", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/bin/tini", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/6b84624795708f94f1ab4a9ae5bb3968ee4f420026051eda574aef82894dd381/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 12699, "Restarting": false, "Running": true, "StartedAt": "2025-12-07T18:41:38.523791512Z", "Status": "running"}}}
ok: [web-2.ru-central1.internal] => {"ansible_facts": {"docker_container": {"AppArmorProfile": "docker-default", "Args": ["--", "/usr/local/bin/docker-entrypoint", "--environment", "container"], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["--environment", "container"], "Domainname": "", "Entrypoint": ["/usr/bin/tini", "--", "/usr/local/bin/docker-entrypoint"], "Env": ["PATH=/usr/share/filebeat:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "ELASTIC_CONTAINER=true", "GODEBUG=madvdontneed=1", "LIBBEAT_MONITORING_CGROUPS_HIERARCHY_OVERRIDE=/"], "Hostname": "835d915f3e21", "Image": "elastic/filebeat:8.19.6", "Labels": {"description": "Filebeat sends log files to Logstash or directly to Elasticsearch.", "io.k8s.description": "Filebeat sends log files to Logstash or directly to Elasticsearch.", "io.k8s.display-name": "Filebeat image", "license": "Elastic License", "maintainer": "infra@elastic.co", "name": "filebeat", "org.label-schema.build-date": "2025-10-21T18:51:53Z", "org.label-schema.license": "Elastic License", "org.label-schema.name": "filebeat", "org.label-schema.schema-version": "1.0", "org.label-schema.url": "https://www.elastic.co/beats/filebeat", "org.label-schema.vcs-ref": "ac8655385a99413beadaa6ef2447a1203fcb84d8", "org.label-schema.vcs-url": "github.com/elastic/beats/v7", "org.label-schema.vendor": "Elastic", "org.label-schema.version": "8.19.6", "org.opencontainers.image.authors": "infra@elastic.co", "org.opencontainers.image.created": "2025-10-21T18:51:53Z", "org.opencontainers.image.licenses": "Elastic License", "org.opencontainers.image.ref.name": "ubuntu", "org.opencontainers.image.title": "Filebeat", "org.opencontainers.image.vendor": "Elastic", "org.opencontainers.image.version": "24.04", "release": "1", "summary": "filebeat", "url": "https://www.elastic.co/beats/filebeat", "vendor": "Elastic", "version": "8.19.6"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "root", "Volumes": null, "WorkingDir": "/usr/share/filebeat"}, "Created": "2025-12-07T18:41:38.492323431Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"ID": "835d915f3e215159e9c070c5a3df99831f398d3e66eb1a613c60d452288e493a", "LowerDir": "/var/lib/docker/overlay2/52f637be837c7a205d2fd2db50074fe981aa0c372066a04c3bddbfdf2d7ce3a2-init/diff:/var/lib/docker/overlay2/5a8c8b080a48e37bf21b16135728deabf666b48fbdb0e60c05cc4516dd933fc1/diff:/var/lib/docker/overlay2/2c2566f4d087cd0c03cf91d5f76413512b8bdd417ae452b6ecc9766948705879/diff:/var/lib/docker/overlay2/2346cace566032b84698d9d31e81e8028833777e32d9cb0343621929b8c7d204/diff:/var/lib/docker/overlay2/82d5730e175c1829eb7ba454445c6710e87b2bee8e525b0e17c14d5631e1e1ba/diff:/var/lib/docker/overlay2/42b4272b3fda6db8e46f51952206a6c05d89375263451742cab73f1307816adc/diff:/var/lib/docker/overlay2/e181f00b1d2fc9921e5ce14a54929c9ef5e00dc9aa99d0adb2a3169f50a88fca/diff:/var/lib/docker/overlay2/3a11b755ffbc9d2e95f2ae0b8b4279a6bb0bf92f7a9ad953c767bae460829697/diff:/var/lib/docker/overlay2/4a387e2efe899dbd90fb8345d8601bd755dd817dad67492689aeecb22feb3af5/diff:/var/lib/docker/overlay2/39d3159988c9a17f05c0c4fde3f7d8a9b7b58ff71bfad5a6d7e54a075c7ddd61/diff:/var/lib/docker/overlay2/17a9c04665d61b7757e30e1cb4a84454c07679e09a7550f61b73dabfa345ae23/diff:/var/lib/docker/overlay2/9663ba737bb332e20ec4447221e5497af3706507e567f725df0d8555cc08a495/diff:/var/lib/docker/overlay2/e604abf792f898d4b1bf6df9a0ffd5faee7dc533278bdbfcd0d1177b8f02823d/diff:/var/lib/docker/overlay2/13e7c1f1350ecf1d46120f27e08cb18c9133e7a0cd831287790b77769366156a/diff:/var/lib/docker/overlay2/629da7cd40fa2dbfa43782efe64ba4ec5f9d3642aa9b6508a0bac2a736e79754/diff", "MergedDir": "/var/lib/docker/overlay2/52f637be837c7a205d2fd2db50074fe981aa0c372066a04c3bddbfdf2d7ce3a2/merged", "UpperDir": "/var/lib/docker/overlay2/52f637be837c7a205d2fd2db50074fe981aa0c372066a04c3bddbfdf2d7ce3a2/diff", "WorkDir": "/var/lib/docker/overlay2/52f637be837c7a205d2fd2db50074fe981aa0c372066a04c3bddbfdf2d7ce3a2/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": ["/var/log/nginx:/var/log/nginx:ro", "/etc/filebeat/filebeat.yml:/usr/share/filebeat/filebeat.yml:ro"], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Cgroup": "", "CgroupParent": "", "CgroupnsMode": "private", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": ["/proc/asound", "/proc/acpi", "/proc/interrupts", "/proc/kcore", "/proc/keys", "/proc/latency_stats", "/proc/timer_list", "/proc/timer_stats", "/proc/sched_debug", "/proc/scsi", "/sys/firmware", "/sys/devices/virtual/powercap"], "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "bridge", "OomKillDisable": null, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": false, "PublishAllPorts": false, "ReadonlyPaths": ["/proc/bus", "/proc/fs", "/proc/irq", "/proc/sys", "/proc/sysrq-trigger"], "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": "always"}, "Runtime": "runc", "SecurityOpt": null, "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/835d915f3e215159e9c070c5a3df99831f398d3e66eb1a613c60d452288e493a/hostname", "HostsPath": "/var/lib/docker/containers/835d915f3e215159e9c070c5a3df99831f398d3e66eb1a613c60d452288e493a/hosts", "Id": "835d915f3e215159e9c070c5a3df99831f398d3e66eb1a613c60d452288e493a", "Image": "sha256:ad91d8c153111847623d7c8b3d4f2498655ecd1984b4e39571e213ce22d0a5a7", "LogPath": "/var/lib/docker/containers/835d915f3e215159e9c070c5a3df99831f398d3e66eb1a613c60d452288e493a/835d915f3e215159e9c070c5a3df99831f398d3e66eb1a613c60d452288e493a-json.log", "MountLabel": "", "Mounts": [{"Destination": "/var/log/nginx", "Mode": "ro", "Propagation": "rprivate", "RW": false, "Source": "/var/log/nginx", "Type": "bind"}, {"Destination": "/usr/share/filebeat/filebeat.yml", "Mode": "ro", "Propagation": "rprivate", "RW": false, "Source": "/etc/filebeat/filebeat.yml", "Type": "bind"}], "Name": "/filebeat", "NetworkSettings": {"Bridge": "", "EndpointID": "bd546bff81fb3b22f88962b9b0a2a1cf97ee0e64a57bb6653cb67300767094f9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "3a:f2:74:44:69:8f", "Networks": {"bridge": {"Aliases": null, "DNSNames": null, "DriverOpts": null, "EndpointID": "bd546bff81fb3b22f88962b9b0a2a1cf97ee0e64a57bb6653cb67300767094f9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "GwPriority": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "3a:f2:74:44:69:8f", "NetworkID": "7d731e4c47859c82659bf3810392e6eb08c3c09cece8753d9e01d2fcf819f4f5"}}, "Ports": {}, "SandboxID": "4c3e2c434e940757bba7f448663cb0495780f6800a7527c813c72238ae1f546a", "SandboxKey": "/var/run/docker/netns/4c3e2c434e94", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/bin/tini", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/835d915f3e215159e9c070c5a3df99831f398d3e66eb1a613c60d452288e493a/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 12703, "Restarting": false, "Running": true, "StartedAt": "2025-12-07T18:41:38.594825165Z", "Status": "running"}}}, "changed": false, "container": {"AppArmorProfile": "docker-default", "Args": ["--", "/usr/local/bin/docker-entrypoint", "--environment", "container"], "Config": {"AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": ["--environment", "container"], "Domainname": "", "Entrypoint": ["/usr/bin/tini", "--", "/usr/local/bin/docker-entrypoint"], "Env": ["PATH=/usr/share/filebeat:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", "ELASTIC_CONTAINER=true", "GODEBUG=madvdontneed=1", "LIBBEAT_MONITORING_CGROUPS_HIERARCHY_OVERRIDE=/"], "Hostname": "835d915f3e21", "Image": "elastic/filebeat:8.19.6", "Labels": {"description": "Filebeat sends log files to Logstash or directly to Elasticsearch.", "io.k8s.description": "Filebeat sends log files to Logstash or directly to Elasticsearch.", "io.k8s.display-name": "Filebeat image", "license": "Elastic License", "maintainer": "infra@elastic.co", "name": "filebeat", "org.label-schema.build-date": "2025-10-21T18:51:53Z", "org.label-schema.license": "Elastic License", "org.label-schema.name": "filebeat", "org.label-schema.schema-version": "1.0", "org.label-schema.url": "https://www.elastic.co/beats/filebeat", "org.label-schema.vcs-ref": "ac8655385a99413beadaa6ef2447a1203fcb84d8", "org.label-schema.vcs-url": "github.com/elastic/beats/v7", "org.label-schema.vendor": "Elastic", "org.label-schema.version": "8.19.6", "org.opencontainers.image.authors": "infra@elastic.co", "org.opencontainers.image.created": "2025-10-21T18:51:53Z", "org.opencontainers.image.licenses": "Elastic License", "org.opencontainers.image.ref.name": "ubuntu", "org.opencontainers.image.title": "Filebeat", "org.opencontainers.image.vendor": "Elastic", "org.opencontainers.image.version": "24.04", "release": "1", "summary": "filebeat", "url": "https://www.elastic.co/beats/filebeat", "vendor": "Elastic", "version": "8.19.6"}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "root", "Volumes": null, "WorkingDir": "/usr/share/filebeat"}, "Created": "2025-12-07T18:41:38.492323431Z", "Driver": "overlay2", "ExecIDs": null, "GraphDriver": {"Data": {"ID": "835d915f3e215159e9c070c5a3df99831f398d3e66eb1a613c60d452288e493a", "LowerDir": "/var/lib/docker/overlay2/52f637be837c7a205d2fd2db50074fe981aa0c372066a04c3bddbfdf2d7ce3a2-init/diff:/var/lib/docker/overlay2/5a8c8b080a48e37bf21b16135728deabf666b48fbdb0e60c05cc4516dd933fc1/diff:/var/lib/docker/overlay2/2c2566f4d087cd0c03cf91d5f76413512b8bdd417ae452b6ecc9766948705879/diff:/var/lib/docker/overlay2/2346cace566032b84698d9d31e81e8028833777e32d9cb0343621929b8c7d204/diff:/var/lib/docker/overlay2/82d5730e175c1829eb7ba454445c6710e87b2bee8e525b0e17c14d5631e1e1ba/diff:/var/lib/docker/overlay2/42b4272b3fda6db8e46f51952206a6c05d89375263451742cab73f1307816adc/diff:/var/lib/docker/overlay2/e181f00b1d2fc9921e5ce14a54929c9ef5e00dc9aa99d0adb2a3169f50a88fca/diff:/var/lib/docker/overlay2/3a11b755ffbc9d2e95f2ae0b8b4279a6bb0bf92f7a9ad953c767bae460829697/diff:/var/lib/docker/overlay2/4a387e2efe899dbd90fb8345d8601bd755dd817dad67492689aeecb22feb3af5/diff:/var/lib/docker/overlay2/39d3159988c9a17f05c0c4fde3f7d8a9b7b58ff71bfad5a6d7e54a075c7ddd61/diff:/var/lib/docker/overlay2/17a9c04665d61b7757e30e1cb4a84454c07679e09a7550f61b73dabfa345ae23/diff:/var/lib/docker/overlay2/9663ba737bb332e20ec4447221e5497af3706507e567f725df0d8555cc08a495/diff:/var/lib/docker/overlay2/e604abf792f898d4b1bf6df9a0ffd5faee7dc533278bdbfcd0d1177b8f02823d/diff:/var/lib/docker/overlay2/13e7c1f1350ecf1d46120f27e08cb18c9133e7a0cd831287790b77769366156a/diff:/var/lib/docker/overlay2/629da7cd40fa2dbfa43782efe64ba4ec5f9d3642aa9b6508a0bac2a736e79754/diff", "MergedDir": "/var/lib/docker/overlay2/52f637be837c7a205d2fd2db50074fe981aa0c372066a04c3bddbfdf2d7ce3a2/merged", "UpperDir": "/var/lib/docker/overlay2/52f637be837c7a205d2fd2db50074fe981aa0c372066a04c3bddbfdf2d7ce3a2/diff", "WorkDir": "/var/lib/docker/overlay2/52f637be837c7a205d2fd2db50074fe981aa0c372066a04c3bddbfdf2d7ce3a2/work"}, "Name": "overlay2"}, "HostConfig": {"AutoRemove": false, "Binds": ["/var/log/nginx:/var/log/nginx:ro", "/etc/filebeat/filebeat.yml:/usr/share/filebeat/filebeat.yml:ro"], "BlkioDeviceReadBps": null, "BlkioDeviceReadIOps": null, "BlkioDeviceWriteBps": null, "BlkioDeviceWriteIOps": null, "BlkioWeight": 0, "BlkioWeightDevice": null, "CapAdd": null, "CapDrop": null, "Cgroup": "", "CgroupParent": "", "CgroupnsMode": "private", "ConsoleSize": [0, 0], "ContainerIDFile": "", "CpuCount": 0, "CpuPercent": 0, "CpuPeriod": 0, "CpuQuota": 0, "CpuRealtimePeriod": 0, "CpuRealtimeRuntime": 0, "CpuShares": 0, "CpusetCpus": "", "CpusetMems": "", "DeviceCgroupRules": null, "DeviceRequests": null, "Devices": null, "Dns": null, "DnsOptions": null, "DnsSearch": null, "ExtraHosts": null, "GroupAdd": null, "IOMaximumBandwidth": 0, "IOMaximumIOps": 0, "Init": false, "IpcMode": "private", "Isolation": "", "Links": null, "LogConfig": {"Config": {}, "Type": "json-file"}, "MaskedPaths": ["/proc/asound", "/proc/acpi", "/proc/interrupts", "/proc/kcore", "/proc/keys", "/proc/latency_stats", "/proc/timer_list", "/proc/timer_stats", "/proc/sched_debug", "/proc/scsi", "/sys/firmware", "/sys/devices/virtual/powercap"], "Memory": 0, "MemoryReservation": 0, "MemorySwap": 0, "MemorySwappiness": null, "NanoCpus": 0, "NetworkMode": "bridge", "OomKillDisable": null, "OomScoreAdj": 0, "PidMode": "", "PidsLimit": null, "PortBindings": null, "Privileged": false, "PublishAllPorts": false, "ReadonlyPaths": ["/proc/bus", "/proc/fs", "/proc/irq", "/proc/sys", "/proc/sysrq-trigger"], "ReadonlyRootfs": false, "RestartPolicy": {"MaximumRetryCount": 0, "Name": "always"}, "Runtime": "runc", "SecurityOpt": null, "ShmSize": 67108864, "UTSMode": "", "Ulimits": null, "UsernsMode": "", "VolumeDriver": "", "VolumesFrom": null}, "HostnamePath": "/var/lib/docker/containers/835d915f3e215159e9c070c5a3df99831f398d3e66eb1a613c60d452288e493a/hostname", "HostsPath": "/var/lib/docker/containers/835d915f3e215159e9c070c5a3df99831f398d3e66eb1a613c60d452288e493a/hosts", "Id": "835d915f3e215159e9c070c5a3df99831f398d3e66eb1a613c60d452288e493a", "Image": "sha256:ad91d8c153111847623d7c8b3d4f2498655ecd1984b4e39571e213ce22d0a5a7", "LogPath": "/var/lib/docker/containers/835d915f3e215159e9c070c5a3df99831f398d3e66eb1a613c60d452288e493a/835d915f3e215159e9c070c5a3df99831f398d3e66eb1a613c60d452288e493a-json.log", "MountLabel": "", "Mounts": [{"Destination": "/var/log/nginx", "Mode": "ro", "Propagation": "rprivate", "RW": false, "Source": "/var/log/nginx", "Type": "bind"}, {"Destination": "/usr/share/filebeat/filebeat.yml", "Mode": "ro", "Propagation": "rprivate", "RW": false, "Source": "/etc/filebeat/filebeat.yml", "Type": "bind"}], "Name": "/filebeat", "NetworkSettings": {"Bridge": "", "EndpointID": "bd546bff81fb3b22f88962b9b0a2a1cf97ee0e64a57bb6653cb67300767094f9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "HairpinMode": false, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "LinkLocalIPv6Address": "", "LinkLocalIPv6PrefixLen": 0, "MacAddress": "3a:f2:74:44:69:8f", "Networks": {"bridge": {"Aliases": null, "DNSNames": null, "DriverOpts": null, "EndpointID": "bd546bff81fb3b22f88962b9b0a2a1cf97ee0e64a57bb6653cb67300767094f9", "Gateway": "172.17.0.1", "GlobalIPv6Address": "", "GlobalIPv6PrefixLen": 0, "GwPriority": 0, "IPAMConfig": null, "IPAddress": "172.17.0.2", "IPPrefixLen": 16, "IPv6Gateway": "", "Links": null, "MacAddress": "3a:f2:74:44:69:8f", "NetworkID": "7d731e4c47859c82659bf3810392e6eb08c3c09cece8753d9e01d2fcf819f4f5"}}, "Ports": {}, "SandboxID": "4c3e2c434e940757bba7f448663cb0495780f6800a7527c813c72238ae1f546a", "SandboxKey": "/var/run/docker/netns/4c3e2c434e94", "SecondaryIPAddresses": null, "SecondaryIPv6Addresses": null}, "Path": "/usr/bin/tini", "Platform": "linux", "ProcessLabel": "", "ResolvConfPath": "/var/lib/docker/containers/835d915f3e215159e9c070c5a3df99831f398d3e66eb1a613c60d452288e493a/resolv.conf", "RestartCount": 0, "State": {"Dead": false, "Error": "", "ExitCode": 0, "FinishedAt": "0001-01-01T00:00:00Z", "OOMKilled": false, "Paused": false, "Pid": 12703, "Restarting": false, "Running": true, "StartedAt": "2025-12-07T18:41:38.594825165Z", "Status": "running"}}}

TASK [Wait for Elasticsearch to respond (with timeout)] ************************
skipping: [web-1.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
skipping: [web-2.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
skipping: [zabbix.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
skipping: [kibana.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
ok: [elasticsearch.ru-central1.internal] => {"changed": false, "elapsed": 0, "match_groupdict": {}, "match_groups": [], "path": null, "port": 9200, "search_regex": null, "state": "started"}

TASK [Wait for Kibana to respond (with timeout)] *******************************
skipping: [web-1.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
skipping: [elasticsearch.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
skipping: [web-2.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
skipping: [zabbix.ru-central1.internal] => {"changed": false, "skip_reason": "Conditional result was False"}
ok: [kibana.ru-central1.internal] => {"changed": false, "elapsed": 0, "match_groupdict": {}, "match_groups": [], "path": null, "port": 5601, "search_regex": null, "state": "started"}

PLAY RECAP *********************************************************************
elasticsearch.ru-central1.internal : ok=5    changed=0    unreachable=0    failed=0    skipped=5    rescued=0    ignored=0   
kibana.ru-central1.internal : ok=4    changed=0    unreachable=0    failed=0    skipped=6    rescued=0    ignored=0   
web-1.ru-central1.internal : ok=5    changed=0    unreachable=0    failed=0    skipped=5    rescued=0    ignored=0   
web-2.ru-central1.internal : ok=5    changed=0    unreachable=0    failed=0    skipped=5    rescued=0    ignored=0   
zabbix.ru-central1.internal : ok=2    changed=0    unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   


=== DEPLOYMENT COMPLETE: Sun Dec  7 07:06:32 PM UTC 2025 ===
âœ… All playbooks executed successfully
